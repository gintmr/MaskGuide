04/11/2025 17:19:20 - INFO - lightning_fabric.utilities.distributed -   Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
04/11/2025 17:19:20 - INFO - torch.distributed.distributed_c10d -   Added key: store_based_barrier_key:1 to store for rank: 2
04/11/2025 17:19:20 - INFO - lightning_fabric.utilities.distributed -   Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
04/11/2025 17:19:20 - INFO - torch.distributed.distributed_c10d -   Added key: store_based_barrier_key:1 to store for rank: 1
04/11/2025 17:19:20 - INFO - lightning_fabric.utilities.distributed -   Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
04/11/2025 17:19:20 - INFO - torch.distributed.distributed_c10d -   Added key: store_based_barrier_key:1 to store for rank: 3
04/11/2025 17:19:20 - INFO - torch.distributed.distributed_c10d -   Added key: store_based_barrier_key:1 to store for rank: 0
04/11/2025 17:19:20 - INFO - torch.distributed.distributed_c10d -   Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
04/11/2025 17:19:20 - INFO - torch.distributed.distributed_c10d -   Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
04/11/2025 17:19:20 - INFO - pytorch_lightning.utilities.rank_zero -   ----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

04/11/2025 17:19:20 - INFO - torch.distributed.distributed_c10d -   Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
04/11/2025 17:19:20 - INFO - torch.distributed.distributed_c10d -   Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory /data2/wuxinrui/RA-L/MobileSAM/trained_models/Distilled_encoder exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
04/11/2025 17:19:24 - INFO - pytorch_lightning.accelerators.cuda -   LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
04/11/2025 17:19:24 - INFO - pytorch_lightning.accelerators.cuda -   LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
04/11/2025 17:19:24 - INFO - pytorch_lightning.accelerators.cuda -   LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
04/11/2025 17:19:24 - INFO - pytorch_lightning.accelerators.cuda -   LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
04/11/2025 17:19:24 - INFO - pytorch_lightning.callbacks.model_summary -   
  | Name    | Type | Params
---------------------------------
0 | T_model | Sam  | 10.1 M
1 | S_model | Sam  | 10.1 M
---------------------------------
10.1 M    Trainable params
10.1 M    Non-trainable params
20.3 M    Total params
40.520    Total estimated model params size (MB)
loading annotations into memory...
Done (t=0.33s)
creating index...
index created!
loading annotations into memory...
Done (t=0.12s)
creating index...
index created!
T_model inited by /data2/wuxinrui/RA-L/MobileSAM/weights/mobile_sam.pt
T_model inited by /data2/wuxinrui/RA-L/MobileSAM/trained_models/Distilled_encoder/COCO_train_1epoch.pth
Training: 0it [00:00, ?it/s]Training:   0%|          | 0/1818 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/1818 [00:00<?, ?it/s] loading annotations into memory...
Done (t=0.19s)
creating index...
index created!
loading annotations into memory...
Done (t=0.05s)
creating index...
index created!
T_model inited by /data2/wuxinrui/RA-L/MobileSAM/weights/mobile_sam.pt
T_model inited by /data2/wuxinrui/RA-L/MobileSAM/trained_models/Distilled_encoder/COCO_train_1epoch.pth
loading annotations into memory...
Done (t=0.20s)
creating index...
index created!
loading annotations into memory...
Done (t=0.05s)
creating index...
index created!
T_model inited by /data2/wuxinrui/RA-L/MobileSAM/weights/mobile_sam.pt
T_model inited by /data2/wuxinrui/RA-L/MobileSAM/trained_models/Distilled_encoder/COCO_train_1epoch.pth
loading annotations into memory...
Done (t=0.20s)
creating index...
index created!
loading annotations into memory...
Done (t=0.05s)
creating index...
index created!
T_model inited by /data2/wuxinrui/RA-L/MobileSAM/weights/mobile_sam.pt
T_model inited by /data2/wuxinrui/RA-L/MobileSAM/trained_models/Distilled_encoder/COCO_train_1epoch.pth
/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch 0:   0%|          | 1/1818 [00:02<1:22:59,  2.74s/it]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   0%|          | 1/1818 [00:02<1:23:02,  2.74s/it, loss=0.408, v_num=77, loss_focal=0.00115, loss_dice=0.110, distill_loss=0.162, acc=0.998, av_BS_IoU=0.848, av_BS_pa=0.998, loss_iou=0.0667, train_per_mask_iou=0.857]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch 0:   0%|          | 2/1818 [00:04<1:01:08,  2.02s/it, loss=0.408, v_num=77, loss_focal=0.00115, loss_dice=0.110, distill_loss=0.162, acc=0.998, av_BS_IoU=0.848, av_BS_pa=0.998, loss_iou=0.0667, train_per_mask_iou=0.857]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   0%|          | 2/1818 [00:04<1:01:10,  2.02s/it, loss=2.010, v_num=77, loss_focal=0.0184, loss_dice=0.852, distill_loss=0.245, acc=0.963, av_BS_IoU=0.236, av_BS_pa=0.915, loss_iou=0.00221, train_per_mask_iou=0.616]Epoch 0:   0%|          | 3/1818 [00:04<46:26,  1.53s/it, loss=2.010, v_num=77, loss_focal=0.0184, loss_dice=0.852, distill_loss=0.245, acc=0.963, av_BS_IoU=0.236, av_BS_pa=0.915, loss_iou=0.00221, train_per_mask_iou=0.616]  Epoch 0:   0%|          | 3/1818 [00:04<46:26,  1.54s/it, loss=0.513, v_num=77, loss_focal=0.00219, loss_dice=0.262, distill_loss=0.156, acc=0.995, av_BS_IoU=0.902, av_BS_pa=0.992, loss_iou=0.0284, train_per_mask_iou=0.722]Epoch 0:   0%|          | 4/1818 [00:05<39:10,  1.30s/it, loss=0.513, v_num=77, loss_focal=0.00219, loss_dice=0.262, distill_loss=0.156, acc=0.995, av_BS_IoU=0.902, av_BS_pa=0.992, loss_iou=0.0284, train_per_mask_iou=0.722]Epoch 0:   0%|          | 4/1818 [00:05<39:11,  1.30s/it, loss=0.668, v_num=77, loss_focal=0.000888, loss_dice=0.374, distill_loss=0.200, acc=0.996, av_BS_IoU=0.930, av_BS_pa=0.996, loss_iou=0.0271, train_per_mask_iou=0.772]Epoch 0:   0%|          | 5/1818 [00:05<34:46,  1.15s/it, loss=0.668, v_num=77, loss_focal=0.000888, loss_dice=0.374, distill_loss=0.200, acc=0.996, av_BS_IoU=0.930, av_BS_pa=0.996, loss_iou=0.0271, train_per_mask_iou=0.772]Epoch 0:   0%|          | 5/1818 [00:05<34:46,  1.15s/it, loss=0.427, v_num=77, loss_focal=0.000902, loss_dice=0.133, distill_loss=0.213, acc=0.998, av_BS_IoU=0.865, av_BS_pa=0.998, loss_iou=0.00452, train_per_mask_iou=0.792]Epoch 0:   0%|          | 6/1818 [00:06<32:01,  1.06s/it, loss=0.427, v_num=77, loss_focal=0.000902, loss_dice=0.133, distill_loss=0.213, acc=0.998, av_BS_IoU=0.865, av_BS_pa=0.998, loss_iou=0.00452, train_per_mask_iou=0.792]Epoch 0:   0%|          | 6/1818 [00:06<32:02,  1.06s/it, loss=0.320, v_num=77, loss_focal=0.0055, loss_dice=0.0572, distill_loss=0.185, acc=0.993, av_BS_IoU=0.921, av_BS_pa=0.992, loss_iou=0.000474, train_per_mask_iou=0.814]Epoch 0:   0%|          | 7/1818 [00:06<29:53,  1.01it/s, loss=0.320, v_num=77, loss_focal=0.0055, loss_dice=0.0572, distill_loss=0.185, acc=0.993, av_BS_IoU=0.921, av_BS_pa=0.992, loss_iou=0.000474, train_per_mask_iou=0.814]Epoch 0:   0%|          | 7/1818 [00:06<29:53,  1.01it/s, loss=1.210, v_num=77, loss_focal=0.0118, loss_dice=0.658, distill_loss=0.209, acc=0.938, av_BS_IoU=0.613, av_BS_pa=0.965, loss_iou=0.0106, train_per_mask_iou=0.734]   Epoch 0:   0%|          | 8/1818 [00:07<28:37,  1.05it/s, loss=1.210, v_num=77, loss_focal=0.0118, loss_dice=0.658, distill_loss=0.209, acc=0.938, av_BS_IoU=0.613, av_BS_pa=0.965, loss_iou=0.0106, train_per_mask_iou=0.734]Epoch 0:   0%|          | 8/1818 [00:07<28:37,  1.05it/s, loss=0.424, v_num=77, loss_focal=0.00268, loss_dice=0.161, distill_loss=0.186, acc=0.993, av_BS_IoU=0.928, av_BS_pa=0.990, loss_iou=0.0108, train_per_mask_iou=0.761]Epoch 0:   0%|          | 9/1818 [00:08<27:31,  1.10it/s, loss=0.424, v_num=77, loss_focal=0.00268, loss_dice=0.161, distill_loss=0.186, acc=0.993, av_BS_IoU=0.928, av_BS_pa=0.990, loss_iou=0.0108, train_per_mask_iou=0.761]Epoch 0:   0%|          | 9/1818 [00:08<27:31,  1.10it/s, loss=0.278, v_num=77, loss_focal=0.00337, loss_dice=0.0682, distill_loss=0.153, acc=0.988, av_BS_IoU=0.939, av_BS_pa=0.989, loss_iou=0.000211, train_per_mask_iou=0.780]Epoch 0:   1%|          | 10/1818 [00:08<26:38,  1.13it/s, loss=0.278, v_num=77, loss_focal=0.00337, loss_dice=0.0682, distill_loss=0.153, acc=0.988, av_BS_IoU=0.939, av_BS_pa=0.989, loss_iou=0.000211, train_per_mask_iou=0.780]Epoch 0:   1%|          | 10/1818 [00:08<26:38,  1.13it/s, loss=0.808, v_num=77, loss_focal=0.0163, loss_dice=0.378, distill_loss=0.138, acc=0.968, av_BS_IoU=0.583, av_BS_pa=0.891, loss_iou=0.0135, train_per_mask_iou=0.785]    Epoch 0:   1%|          | 11/1818 [00:10<27:45,  1.08it/s, loss=0.808, v_num=77, loss_focal=0.0163, loss_dice=0.378, distill_loss=0.138, acc=0.968, av_BS_IoU=0.583, av_BS_pa=0.891, loss_iou=0.0135, train_per_mask_iou=0.785]Epoch 0:   1%|          | 11/1818 [00:10<27:46,  1.08it/s, loss=0.373, v_num=77, loss_focal=0.00135, loss_dice=0.133, distill_loss=0.129, acc=0.992, av_BS_IoU=0.965, av_BS_pa=0.995, loss_iou=0.0728, train_per_mask_iou=0.799]Epoch 0:   1%|          | 12/1818 [00:10<27:10,  1.11it/s, loss=0.373, v_num=77, loss_focal=0.00135, loss_dice=0.133, distill_loss=0.129, acc=0.992, av_BS_IoU=0.965, av_BS_pa=0.995, loss_iou=0.0728, train_per_mask_iou=0.799]Epoch 0:   1%|          | 12/1818 [00:10<27:10,  1.11it/s, loss=1.610, v_num=77, loss_focal=0.0116, loss_dice=0.782, distill_loss=0.183, acc=0.331, av_BS_IoU=0.480, av_BS_pa=0.962, loss_iou=0.130, train_per_mask_iou=0.792]  Epoch 0:   1%|          | 13/1818 [00:11<27:29,  1.09it/s, loss=1.610, v_num=77, loss_focal=0.0116, loss_dice=0.782, distill_loss=0.183, acc=0.331, av_BS_IoU=0.480, av_BS_pa=0.962, loss_iou=0.130, train_per_mask_iou=0.792]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   1%|          | 13/1818 [00:11<27:29,  1.09it/s, loss=0.389, v_num=77, loss_focal=0.00383, loss_dice=0.123, distill_loss=0.180, acc=0.988, av_BS_IoU=0.911, av_BS_pa=0.984, loss_iou=0.0145, train_per_mask_iou=0.801]Epoch 0:   1%|          | 14/1818 [00:12<26:44,  1.12it/s, loss=0.389, v_num=77, loss_focal=0.00383, loss_dice=0.123, distill_loss=0.180, acc=0.988, av_BS_IoU=0.911, av_BS_pa=0.984, loss_iou=0.0145, train_per_mask_iou=0.801]Epoch 0:   1%|          | 14/1818 [00:12<26:44,  1.12it/s, loss=0.287, v_num=77, loss_focal=0.00223, loss_dice=0.0924, distill_loss=0.132, acc=0.997, av_BS_IoU=0.860, av_BS_pa=0.997, loss_iou=0.00593, train_per_mask_iou=0.805]Epoch 0:   1%|          | 15/1818 [00:13<26:10,  1.15it/s, loss=0.287, v_num=77, loss_focal=0.00223, loss_dice=0.0924, distill_loss=0.132, acc=0.997, av_BS_IoU=0.860, av_BS_pa=0.997, loss_iou=0.00593, train_per_mask_iou=0.805]Epoch 0:   1%|          | 15/1818 [00:13<26:10,  1.15it/s, loss=0.484, v_num=77, loss_focal=0.00264, loss_dice=0.138, distill_loss=0.237, acc=0.996, av_BS_IoU=0.816, av_BS_pa=0.996, loss_iou=0.00286, train_per_mask_iou=0.807] Epoch 0:   1%|          | 16/1818 [00:13<25:43,  1.17it/s, loss=0.484, v_num=77, loss_focal=0.00264, loss_dice=0.138, distill_loss=0.237, acc=0.996, av_BS_IoU=0.816, av_BS_pa=0.996, loss_iou=0.00286, train_per_mask_iou=0.807]Epoch 0:   1%|          | 16/1818 [00:13<25:43,  1.17it/s, loss=0.370, v_num=77, loss_focal=0.00244, loss_dice=0.127, distill_loss=0.160, acc=0.993, av_BS_IoU=0.937, av_BS_pa=0.987, loss_iou=0.0274, train_per_mask_iou=0.816] Epoch 0:   1%|          | 17/1818 [00:14<25:20,  1.18it/s, loss=0.370, v_num=77, loss_focal=0.00244, loss_dice=0.127, distill_loss=0.160, acc=0.993, av_BS_IoU=0.937, av_BS_pa=0.987, loss_iou=0.0274, train_per_mask_iou=0.816]Epoch 0:   1%|          | 17/1818 [00:14<25:20,  1.18it/s, loss=0.254, v_num=77, loss_focal=0.00219, loss_dice=0.0431, distill_loss=0.159, acc=0.994, av_BS_IoU=0.949, av_BS_pa=0.992, loss_iou=0.0025, train_per_mask_iou=0.823]Epoch 0:   1%|          | 18/1818 [00:15<25:04,  1.20it/s, loss=0.254, v_num=77, loss_focal=0.00219, loss_dice=0.0431, distill_loss=0.159, acc=0.994, av_BS_IoU=0.949, av_BS_pa=0.992, loss_iou=0.0025, train_per_mask_iou=0.823]Epoch 0:   1%|          | 18/1818 [00:15<25:04,  1.20it/s, loss=0.629, v_num=77, loss_focal=0.00327, loss_dice=0.321, distill_loss=0.191, acc=0.498, av_BS_IoU=0.944, av_BS_pa=0.993, loss_iou=0.0447, train_per_mask_iou=0.837] Epoch 0:   1%|          | 19/1818 [00:15<24:38,  1.22it/s, loss=0.629, v_num=77, loss_focal=0.00327, loss_dice=0.321, distill_loss=0.191, acc=0.498, av_BS_IoU=0.944, av_BS_pa=0.993, loss_iou=0.0447, train_per_mask_iou=0.837]Epoch 0:   1%|          | 19/1818 [00:15<24:38,  1.22it/s, loss=1.540, v_num=77, loss_focal=0.0399, loss_dice=0.567, distill_loss=0.176, acc=0.957, av_BS_IoU=0.327, av_BS_pa=0.928, loss_iou=0.0443, train_per_mask_iou=0.819] Epoch 0:   1%|          | 20/1818 [00:16<24:14,  1.24it/s, loss=1.540, v_num=77, loss_focal=0.0399, loss_dice=0.567, distill_loss=0.176, acc=0.957, av_BS_IoU=0.327, av_BS_pa=0.928, loss_iou=0.0443, train_per_mask_iou=0.819]Epoch 0:   1%|          | 20/1818 [00:16<24:14,  1.24it/s, loss=0.314, v_num=77, loss_focal=0.000995, loss_dice=0.0717, distill_loss=0.183, acc=0.996, av_BS_IoU=0.964, av_BS_pa=0.995, loss_iou=0.0124, train_per_mask_iou=0.826]Epoch 0:   1%|          | 21/1818 [00:16<23:55,  1.25it/s, loss=0.314, v_num=77, loss_focal=0.000995, loss_dice=0.0717, distill_loss=0.183, acc=0.996, av_BS_IoU=0.964, av_BS_pa=0.995, loss_iou=0.0124, train_per_mask_iou=0.826]Epoch 0:   1%|          | 21/1818 [00:16<23:55,  1.25it/s, loss=0.481, v_num=77, loss_focal=0.0151, loss_dice=0.168, distill_loss=0.148, acc=0.978, av_BS_IoU=0.767, av_BS_pa=0.975, loss_iou=0.00483, train_per_mask_iou=0.824]  Epoch 0:   1%|          | 22/1818 [00:17<23:38,  1.27it/s, loss=0.481, v_num=77, loss_focal=0.0151, loss_dice=0.168, distill_loss=0.148, acc=0.978, av_BS_IoU=0.767, av_BS_pa=0.975, loss_iou=0.00483, train_per_mask_iou=0.824]Epoch 0:   1%|          | 22/1818 [00:17<23:38,  1.27it/s, loss=0.546, v_num=77, loss_focal=0.000783, loss_dice=0.265, distill_loss=0.125, acc=0.998, av_BS_IoU=0.785, av_BS_pa=0.998, loss_iou=0.0688, train_per_mask_iou=0.821]Epoch 0:   1%|▏         | 23/1818 [00:17<23:22,  1.28it/s, loss=0.546, v_num=77, loss_focal=0.000783, loss_dice=0.265, distill_loss=0.125, acc=0.998, av_BS_IoU=0.785, av_BS_pa=0.998, loss_iou=0.0688, train_per_mask_iou=0.821]Epoch 0:   1%|▏         | 23/1818 [00:17<23:23,  1.28it/s, loss=1.650, v_num=77, loss_focal=0.0102, loss_dice=0.838, distill_loss=0.166, acc=0.972, av_BS_IoU=0.361, av_BS_pa=0.969, loss_iou=0.0372, train_per_mask_iou=0.799]  Epoch 0:   1%|▏         | 24/1818 [00:18<23:09,  1.29it/s, loss=1.650, v_num=77, loss_focal=0.0102, loss_dice=0.838, distill_loss=0.166, acc=0.972, av_BS_IoU=0.361, av_BS_pa=0.969, loss_iou=0.0372, train_per_mask_iou=0.799]Epoch 0:   1%|▏         | 24/1818 [00:18<23:09,  1.29it/s, loss=0.322, v_num=77, loss_focal=0.00072, loss_dice=0.119, distill_loss=0.147, acc=0.998, av_BS_IoU=0.929, av_BS_pa=0.997, loss_iou=0.0122, train_per_mask_iou=0.804]Epoch 0:   1%|▏         | 25/1818 [00:20<24:10,  1.24it/s, loss=0.322, v_num=77, loss_focal=0.00072, loss_dice=0.119, distill_loss=0.147, acc=0.998, av_BS_IoU=0.929, av_BS_pa=0.997, loss_iou=0.0122, train_per_mask_iou=0.804]Epoch 0:   1%|▏         | 25/1818 [00:20<24:10,  1.24it/s, loss=0.301, v_num=77, loss_focal=0.00147, loss_dice=0.0983, distill_loss=0.135, acc=0.998, av_BS_IoU=0.846, av_BS_pa=0.998, loss_iou=0.00945, train_per_mask_iou=0.806]Epoch 0:   1%|▏         | 26/1818 [00:21<24:33,  1.22it/s, loss=0.301, v_num=77, loss_focal=0.00147, loss_dice=0.0983, distill_loss=0.135, acc=0.998, av_BS_IoU=0.846, av_BS_pa=0.998, loss_iou=0.00945, train_per_mask_iou=0.806]Epoch 0:   1%|▏         | 26/1818 [00:21<24:33,  1.22it/s, loss=0.847, v_num=77, loss_focal=0.00169, loss_dice=0.383, distill_loss=0.207, acc=0.996, av_BS_IoU=0.830, av_BS_pa=0.993, loss_iou=0.135, train_per_mask_iou=0.809]   Epoch 0:   1%|▏         | 27/1818 [00:21<24:18,  1.23it/s, loss=0.847, v_num=77, loss_focal=0.00169, loss_dice=0.383, distill_loss=0.207, acc=0.996, av_BS_IoU=0.830, av_BS_pa=0.993, loss_iou=0.135, train_per_mask_iou=0.809]Epoch 0:   1%|▏         | 27/1818 [00:21<24:18,  1.23it/s, loss=0.974, v_num=77, loss_focal=0.0303, loss_dice=0.413, distill_loss=0.156, acc=0.702, av_BS_IoU=0.573, av_BS_pa=0.815, loss_iou=0.0146, train_per_mask_iou=0.791]Epoch 0:   2%|▏         | 28/1818 [00:22<24:02,  1.24it/s, loss=0.974, v_num=77, loss_focal=0.0303, loss_dice=0.413, distill_loss=0.156, acc=0.702, av_BS_IoU=0.573, av_BS_pa=0.815, loss_iou=0.0146, train_per_mask_iou=0.791]Epoch 0:   2%|▏         | 28/1818 [00:22<24:02,  1.24it/s, loss=0.426, v_num=77, loss_focal=0.00113, loss_dice=0.128, distill_loss=0.186, acc=0.997, av_BS_IoU=0.890, av_BS_pa=0.997, loss_iou=0.0451, train_per_mask_iou=0.794]Epoch 0:   2%|▏         | 29/1818 [00:23<23:47,  1.25it/s, loss=0.426, v_num=77, loss_focal=0.00113, loss_dice=0.128, distill_loss=0.186, acc=0.997, av_BS_IoU=0.890, av_BS_pa=0.997, loss_iou=0.0451, train_per_mask_iou=0.794]Epoch 0:   2%|▏         | 29/1818 [00:23<23:47,  1.25it/s, loss=0.535, v_num=77, loss_focal=0.00271, loss_dice=0.191, distill_loss=0.216, acc=0.498, av_BS_IoU=0.778, av_BS_pa=0.996, loss_iou=0.0111, train_per_mask_iou=0.794]Epoch 0:   2%|▏         | 30/1818 [00:23<23:34,  1.26it/s, loss=0.535, v_num=77, loss_focal=0.00271, loss_dice=0.191, distill_loss=0.216, acc=0.498, av_BS_IoU=0.778, av_BS_pa=0.996, loss_iou=0.0111, train_per_mask_iou=0.794]Epoch 0:   2%|▏         | 30/1818 [00:23<23:34,  1.26it/s, loss=0.395, v_num=77, loss_focal=0.00343, loss_dice=0.0947, distill_loss=0.213, acc=0.995, av_BS_IoU=0.871, av_BS_pa=0.993, loss_iou=0.00282, train_per_mask_iou=0.796]Epoch 0:   2%|▏         | 31/1818 [00:24<23:22,  1.27it/s, loss=0.395, v_num=77, loss_focal=0.00343, loss_dice=0.0947, distill_loss=0.213, acc=0.995, av_BS_IoU=0.871, av_BS_pa=0.993, loss_iou=0.00282, train_per_mask_iou=0.796]Epoch 0:   2%|▏         | 31/1818 [00:24<23:23,  1.27it/s, loss=0.342, v_num=77, loss_focal=0.00538, loss_dice=0.132, distill_loss=0.142, acc=0.967, av_BS_IoU=0.934, av_BS_pa=0.982, loss_iou=0.00106, train_per_mask_iou=0.799] Epoch 0:   2%|▏         | 32/1818 [00:25<23:34,  1.26it/s, loss=0.342, v_num=77, loss_focal=0.00538, loss_dice=0.132, distill_loss=0.142, acc=0.967, av_BS_IoU=0.934, av_BS_pa=0.982, loss_iou=0.00106, train_per_mask_iou=0.799]Epoch 0:   2%|▏         | 32/1818 [00:25<23:34,  1.26it/s, loss=0.275, v_num=77, loss_focal=0.00026, loss_dice=0.0605, distill_loss=0.138, acc=0.500, av_BS_IoU=0.950, av_BS_pa=0.999, loss_iou=0.0409, train_per_mask_iou=0.807]Epoch 0:   2%|▏         | 33/1818 [00:25<23:20,  1.27it/s, loss=0.275, v_num=77, loss_focal=0.00026, loss_dice=0.0605, distill_loss=0.138, acc=0.500, av_BS_IoU=0.950, av_BS_pa=0.999, loss_iou=0.0409, train_per_mask_iou=0.807]Epoch 0:   2%|▏         | 33/1818 [00:25<23:20,  1.27it/s, loss=2.660, v_num=77, loss_focal=0.0857, loss_dice=0.689, distill_loss=0.137, acc=0.849, av_BS_IoU=0.0677, av_BS_pa=0.850, loss_iou=0.135, train_per_mask_iou=0.787]  Epoch 0:   2%|▏         | 34/1818 [00:27<24:02,  1.24it/s, loss=2.660, v_num=77, loss_focal=0.0857, loss_dice=0.689, distill_loss=0.137, acc=0.849, av_BS_IoU=0.0677, av_BS_pa=0.850, loss_iou=0.135, train_per_mask_iou=0.787]Epoch 0:   2%|▏         | 34/1818 [00:27<24:02,  1.24it/s, loss=1.290, v_num=77, loss_focal=0.00343, loss_dice=0.627, distill_loss=0.176, acc=0.991, av_BS_IoU=0.693, av_BS_pa=0.986, loss_iou=0.233, train_per_mask_iou=0.787]Epoch 0:   2%|▏         | 35/1818 [00:28<23:49,  1.25it/s, loss=1.290, v_num=77, loss_focal=0.00343, loss_dice=0.627, distill_loss=0.176, acc=0.991, av_BS_IoU=0.693, av_BS_pa=0.986, loss_iou=0.233, train_per_mask_iou=0.787]Epoch 0:   2%|▏         | 35/1818 [00:28<23:49,  1.25it/s, loss=0.580, v_num=77, loss_focal=0.00366, loss_dice=0.256, distill_loss=0.170, acc=0.991, av_BS_IoU=0.857, av_BS_pa=0.983, loss_iou=0.0607, train_per_mask_iou=0.790]Epoch 0:   2%|▏         | 36/1818 [00:28<23:37,  1.26it/s, loss=0.580, v_num=77, loss_focal=0.00366, loss_dice=0.256, distill_loss=0.170, acc=0.991, av_BS_IoU=0.857, av_BS_pa=0.983, loss_iou=0.0607, train_per_mask_iou=0.790]Epoch 0:   2%|▏         | 36/1818 [00:28<23:37,  1.26it/s, loss=0.602, v_num=77, loss_focal=0.00403, loss_dice=0.311, distill_loss=0.137, acc=0.986, av_BS_IoU=0.655, av_BS_pa=0.986, loss_iou=0.00281, train_per_mask_iou=0.786]Epoch 0:   2%|▏         | 37/1818 [00:29<23:27,  1.27it/s, loss=0.602, v_num=77, loss_focal=0.00403, loss_dice=0.311, distill_loss=0.137, acc=0.986, av_BS_IoU=0.655, av_BS_pa=0.986, loss_iou=0.00281, train_per_mask_iou=0.786]Epoch 0:   2%|▏         | 37/1818 [00:29<23:27,  1.27it/s, loss=0.965, v_num=77, loss_focal=0.015, loss_dice=0.419, distill_loss=0.168, acc=0.962, av_BS_IoU=0.456, av_BS_pa=0.966, loss_iou=0.00735, train_per_mask_iou=0.776]  Epoch 0:   2%|▏         | 38/1818 [00:30<23:41,  1.25it/s, loss=0.965, v_num=77, loss_focal=0.015, loss_dice=0.419, distill_loss=0.168, acc=0.962, av_BS_IoU=0.456, av_BS_pa=0.966, loss_iou=0.00735, train_per_mask_iou=0.776]Epoch 0:   2%|▏         | 38/1818 [00:30<23:41,  1.25it/s, loss=0.688, v_num=77, loss_focal=0.00355, loss_dice=0.302, distill_loss=0.153, acc=0.964, av_BS_IoU=0.939, av_BS_pa=0.991, loss_iou=0.163, train_per_mask_iou=0.776]Epoch 0:   2%|▏         | 39/1818 [00:30<23:30,  1.26it/s, loss=0.688, v_num=77, loss_focal=0.00355, loss_dice=0.302, distill_loss=0.153, acc=0.964, av_BS_IoU=0.939, av_BS_pa=0.991, loss_iou=0.163, train_per_mask_iou=0.776]Epoch 0:   2%|▏         | 39/1818 [00:30<23:30,  1.26it/s, loss=0.352, v_num=77, loss_focal=0.00337, loss_dice=0.0845, distill_loss=0.187, acc=0.997, av_BS_IoU=0.852, av_BS_pa=0.997, loss_iou=0.000512, train_per_mask_iou=0.778]Epoch 0:   2%|▏         | 40/1818 [00:31<23:23,  1.27it/s, loss=0.352, v_num=77, loss_focal=0.00337, loss_dice=0.0845, distill_loss=0.187, acc=0.997, av_BS_IoU=0.852, av_BS_pa=0.997, loss_iou=0.000512, train_per_mask_iou=0.778]Epoch 0:   2%|▏         | 40/1818 [00:31<23:23,  1.27it/s, loss=0.560, v_num=77, loss_focal=0.0047, loss_dice=0.238, distill_loss=0.160, acc=0.996, av_BS_IoU=0.635, av_BS_pa=0.995, loss_iou=0.00444, train_per_mask_iou=0.775]   Epoch 0:   2%|▏         | 41/1818 [00:32<23:27,  1.26it/s, loss=0.560, v_num=77, loss_focal=0.0047, loss_dice=0.238, distill_loss=0.160, acc=0.996, av_BS_IoU=0.635, av_BS_pa=0.995, loss_iou=0.00444, train_per_mask_iou=0.775]Epoch 0:   2%|▏         | 41/1818 [00:32<23:27,  1.26it/s, loss=1.640, v_num=77, loss_focal=0.0108, loss_dice=0.938, distill_loss=0.222, acc=0.989, av_BS_IoU=0.551, av_BS_pa=0.990, loss_iou=0.0176, train_per_mask_iou=0.767] Epoch 0:   2%|▏         | 42/1818 [00:33<23:17,  1.27it/s, loss=1.640, v_num=77, loss_focal=0.0108, loss_dice=0.938, distill_loss=0.222, acc=0.989, av_BS_IoU=0.551, av_BS_pa=0.990, loss_iou=0.0176, train_per_mask_iou=0.767]Epoch 0:   2%|▏         | 42/1818 [00:33<23:17,  1.27it/s, loss=0.615, v_num=77, loss_focal=0.0395, loss_dice=0.174, distill_loss=0.141, acc=0.978, av_BS_IoU=0.765, av_BS_pa=0.978, loss_iou=0.00184, train_per_mask_iou=0.767]Epoch 0:   2%|▏         | 43/1818 [00:33<23:11,  1.28it/s, loss=0.615, v_num=77, loss_focal=0.0395, loss_dice=0.174, distill_loss=0.141, acc=0.978, av_BS_IoU=0.765, av_BS_pa=0.978, loss_iou=0.00184, train_per_mask_iou=0.767]Epoch 0:   2%|▏         | 43/1818 [00:33<23:11,  1.28it/s, loss=0.941, v_num=77, loss_focal=0.0139, loss_dice=0.455, distill_loss=0.179, acc=0.328, av_BS_IoU=0.609, av_BS_pa=0.976, loss_iou=0.0187, train_per_mask_iou=0.762] Epoch 0:   2%|▏         | 44/1818 [00:34<23:02,  1.28it/s, loss=0.941, v_num=77, loss_focal=0.0139, loss_dice=0.455, distill_loss=0.179, acc=0.328, av_BS_IoU=0.609, av_BS_pa=0.976, loss_iou=0.0187, train_per_mask_iou=0.762]Epoch 0:   2%|▏         | 44/1818 [00:34<23:02,  1.28it/s, loss=0.524, v_num=77, loss_focal=0.00376, loss_dice=0.231, distill_loss=0.204, acc=0.986, av_BS_IoU=0.958, av_BS_pa=0.988, loss_iou=0.0185, train_per_mask_iou=0.766]Epoch 0:   2%|▏         | 45/1818 [00:34<22:53,  1.29it/s, loss=0.524, v_num=77, loss_focal=0.00376, loss_dice=0.231, distill_loss=0.204, acc=0.986, av_BS_IoU=0.958, av_BS_pa=0.988, loss_iou=0.0185, train_per_mask_iou=0.766]Epoch 0:   2%|▏         | 45/1818 [00:34<22:53,  1.29it/s, loss=1.100, v_num=77, loss_focal=0.00357, loss_dice=0.579, distill_loss=0.163, acc=0.496, av_BS_IoU=0.491, av_BS_pa=0.988, loss_iou=0.0281, train_per_mask_iou=0.756]Epoch 0:   3%|▎         | 46/1818 [00:35<23:02,  1.28it/s, loss=1.100, v_num=77, loss_focal=0.00357, loss_dice=0.579, distill_loss=0.163, acc=0.496, av_BS_IoU=0.491, av_BS_pa=0.988, loss_iou=0.0281, train_per_mask_iou=0.756]Epoch 0:   3%|▎         | 46/1818 [00:35<23:02,  1.28it/s, loss=0.454, v_num=77, loss_focal=0.00671, loss_dice=0.166, distill_loss=0.172, acc=0.980, av_BS_IoU=0.790, av_BS_pa=0.978, loss_iou=0.000357, train_per_mask_iou=0.757]Epoch 0:   3%|▎         | 47/1818 [00:36<22:53,  1.29it/s, loss=0.454, v_num=77, loss_focal=0.00671, loss_dice=0.166, distill_loss=0.172, acc=0.980, av_BS_IoU=0.790, av_BS_pa=0.978, loss_iou=0.000357, train_per_mask_iou=0.757]Epoch 0:   3%|▎         | 47/1818 [00:36<22:53,  1.29it/s, loss=0.386, v_num=77, loss_focal=0.00655, loss_dice=0.112, distill_loss=0.171, acc=0.987, av_BS_IoU=0.840, av_BS_pa=0.985, loss_iou=0.00493, train_per_mask_iou=0.758] Epoch 0:   3%|▎         | 48/1818 [00:37<22:45,  1.30it/s, loss=0.386, v_num=77, loss_focal=0.00655, loss_dice=0.112, distill_loss=0.171, acc=0.987, av_BS_IoU=0.840, av_BS_pa=0.985, loss_iou=0.00493, train_per_mask_iou=0.758]Epoch 0:   3%|▎         | 48/1818 [00:37<22:46,  1.30it/s, loss=2.210, v_num=77, loss_focal=0.0134, loss_dice=0.915, distill_loss=0.168, acc=0.995, av_BS_IoU=0.254, av_BS_pa=0.962, loss_iou=0.200, train_per_mask_iou=0.757]   Epoch 0:   3%|▎         | 49/1818 [00:38<23:06,  1.28it/s, loss=2.210, v_num=77, loss_focal=0.0134, loss_dice=0.915, distill_loss=0.168, acc=0.995, av_BS_IoU=0.254, av_BS_pa=0.962, loss_iou=0.200, train_per_mask_iou=0.757]Epoch 0:   3%|▎         | 49/1818 [00:38<23:06,  1.28it/s, loss=1.050, v_num=77, loss_focal=0.00414, loss_dice=0.715, distill_loss=0.142, acc=0.992, av_BS_IoU=0.836, av_BS_pa=0.990, loss_iou=0.0603, train_per_mask_iou=0.759]Epoch 0:   3%|▎         | 50/1818 [00:38<22:58,  1.28it/s, loss=1.050, v_num=77, loss_focal=0.00414, loss_dice=0.715, distill_loss=0.142, acc=0.992, av_BS_IoU=0.836, av_BS_pa=0.990, loss_iou=0.0603, train_per_mask_iou=0.759]Epoch 0:   3%|▎         | 50/1818 [00:38<22:58,  1.28it/s, loss=1.150, v_num=77, loss_focal=0.00586, loss_dice=0.700, distill_loss=0.170, acc=0.985, av_BS_IoU=0.723, av_BS_pa=0.981, loss_iou=0.0582, train_per_mask_iou=0.759]Epoch 0:   3%|▎         | 51/1818 [00:40<23:09,  1.27it/s, loss=1.150, v_num=77, loss_focal=0.00586, loss_dice=0.700, distill_loss=0.170, acc=0.985, av_BS_IoU=0.723, av_BS_pa=0.981, loss_iou=0.0582, train_per_mask_iou=0.759]Epoch 0:   3%|▎         | 51/1818 [00:40<23:09,  1.27it/s, loss=1.200, v_num=77, loss_focal=0.0106, loss_dice=0.449, distill_loss=0.198, acc=0.495, av_BS_IoU=0.419, av_BS_pa=0.989, loss_iou=0.113, train_per_mask_iou=0.748]  Epoch 0:   3%|▎         | 52/1818 [00:40<23:02,  1.28it/s, loss=1.200, v_num=77, loss_focal=0.0106, loss_dice=0.449, distill_loss=0.198, acc=0.495, av_BS_IoU=0.419, av_BS_pa=0.989, loss_iou=0.113, train_per_mask_iou=0.748]Epoch 0:   3%|▎         | 52/1818 [00:40<23:02,  1.28it/s, loss=0.955, v_num=77, loss_focal=0.00619, loss_dice=0.499, distill_loss=0.139, acc=0.494, av_BS_IoU=0.532, av_BS_pa=0.978, loss_iou=0.0342, train_per_mask_iou=0.743]Epoch 0:   3%|▎         | 53/1818 [00:41<23:07,  1.27it/s, loss=0.955, v_num=77, loss_focal=0.00619, loss_dice=0.499, distill_loss=0.139, acc=0.494, av_BS_IoU=0.532, av_BS_pa=0.978, loss_iou=0.0342, train_per_mask_iou=0.743]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   3%|▎         | 53/1818 [00:41<23:07,  1.27it/s, loss=0.355, v_num=77, loss_focal=0.000498, loss_dice=0.138, distill_loss=0.141, acc=0.998, av_BS_IoU=0.929, av_BS_pa=0.998, loss_iou=0.0326, train_per_mask_iou=0.746]Epoch 0:   3%|▎         | 54/1818 [00:42<23:00,  1.28it/s, loss=0.355, v_num=77, loss_focal=0.000498, loss_dice=0.138, distill_loss=0.141, acc=0.998, av_BS_IoU=0.929, av_BS_pa=0.998, loss_iou=0.0326, train_per_mask_iou=0.746]Epoch 0:   3%|▎         | 54/1818 [00:42<23:00,  1.28it/s, loss=0.493, v_num=77, loss_focal=0.004, loss_dice=0.218, distill_loss=0.179, acc=0.988, av_BS_IoU=0.918, av_BS_pa=0.986, loss_iou=0.0207, train_per_mask_iou=0.749]   Epoch 0:   3%|▎         | 55/1818 [00:42<22:52,  1.28it/s, loss=0.493, v_num=77, loss_focal=0.004, loss_dice=0.218, distill_loss=0.179, acc=0.988, av_BS_IoU=0.918, av_BS_pa=0.986, loss_iou=0.0207, train_per_mask_iou=0.749]Epoch 0:   3%|▎         | 55/1818 [00:42<22:52,  1.28it/s, loss=0.372, v_num=77, loss_focal=0.00195, loss_dice=0.0527, distill_loss=0.241, acc=0.996, av_BS_IoU=0.920, av_BS_pa=0.995, loss_iou=0.00588, train_per_mask_iou=0.751]Epoch 0:   3%|▎         | 56/1818 [00:43<22:45,  1.29it/s, loss=0.372, v_num=77, loss_focal=0.00195, loss_dice=0.0527, distill_loss=0.241, acc=0.996, av_BS_IoU=0.920, av_BS_pa=0.995, loss_iou=0.00588, train_per_mask_iou=0.751]Epoch 0:   3%|▎         | 56/1818 [00:43<22:45,  1.29it/s, loss=0.407, v_num=77, loss_focal=0.0117, loss_dice=0.140, distill_loss=0.139, acc=0.985, av_BS_IoU=0.812, av_BS_pa=0.984, loss_iou=0.0045, train_per_mask_iou=0.752]   Epoch 0:   3%|▎         | 57/1818 [00:44<22:57,  1.28it/s, loss=0.407, v_num=77, loss_focal=0.0117, loss_dice=0.140, distill_loss=0.139, acc=0.985, av_BS_IoU=0.812, av_BS_pa=0.984, loss_iou=0.0045, train_per_mask_iou=0.752]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   3%|▎         | 57/1818 [00:44<22:57,  1.28it/s, loss=0.371, v_num=77, loss_focal=0.00363, loss_dice=0.109, distill_loss=0.180, acc=0.988, av_BS_IoU=0.906, av_BS_pa=0.987, loss_iou=0.0103, train_per_mask_iou=0.755]Epoch 0:   3%|▎         | 58/1818 [00:45<22:50,  1.28it/s, loss=0.371, v_num=77, loss_focal=0.00363, loss_dice=0.109, distill_loss=0.180, acc=0.988, av_BS_IoU=0.906, av_BS_pa=0.987, loss_iou=0.0103, train_per_mask_iou=0.755]Epoch 0:   3%|▎         | 58/1818 [00:45<22:50,  1.28it/s, loss=0.502, v_num=77, loss_focal=0.0036, loss_dice=0.224, distill_loss=0.190, acc=0.992, av_BS_IoU=0.941, av_BS_pa=0.989, loss_iou=0.0175, train_per_mask_iou=0.758] Epoch 0:   3%|▎         | 59/1818 [00:47<23:28,  1.25it/s, loss=0.502, v_num=77, loss_focal=0.0036, loss_dice=0.224, distill_loss=0.190, acc=0.992, av_BS_IoU=0.941, av_BS_pa=0.989, loss_iou=0.0175, train_per_mask_iou=0.758]Epoch 0:   3%|▎         | 59/1818 [00:47<23:28,  1.25it/s, loss=0.629, v_num=77, loss_focal=0.00372, loss_dice=0.231, distill_loss=0.210, acc=0.979, av_BS_IoU=0.958, av_BS_pa=0.991, loss_iou=0.114, train_per_mask_iou=0.760]Epoch 0:   3%|▎         | 60/1818 [00:47<23:23,  1.25it/s, loss=0.629, v_num=77, loss_focal=0.00372, loss_dice=0.231, distill_loss=0.210, acc=0.979, av_BS_IoU=0.958, av_BS_pa=0.991, loss_iou=0.114, train_per_mask_iou=0.760]Epoch 0:   3%|▎         | 60/1818 [00:47<23:23,  1.25it/s, loss=0.282, v_num=77, loss_focal=0.00312, loss_dice=0.0723, distill_loss=0.148, acc=0.992, av_BS_IoU=0.903, av_BS_pa=0.992, loss_iou=0.00265, train_per_mask_iou=0.762]Epoch 0:   3%|▎         | 61/1818 [00:48<23:16,  1.26it/s, loss=0.282, v_num=77, loss_focal=0.00312, loss_dice=0.0723, distill_loss=0.148, acc=0.992, av_BS_IoU=0.903, av_BS_pa=0.992, loss_iou=0.00265, train_per_mask_iou=0.762]Epoch 0:   3%|▎         | 61/1818 [00:48<23:16,  1.26it/s, loss=18.70, v_num=77, loss_focal=1.480, loss_dice=0.915, distill_loss=0.183, acc=0.176, av_BS_IoU=0.0004, av_BS_pa=0.173, loss_iou=0.779, train_per_mask_iou=0.751]    Epoch 0:   3%|▎         | 62/1818 [00:49<23:10,  1.26it/s, loss=18.70, v_num=77, loss_focal=1.480, loss_dice=0.915, distill_loss=0.183, acc=0.176, av_BS_IoU=0.0004, av_BS_pa=0.173, loss_iou=0.779, train_per_mask_iou=0.751]Epoch 0:   3%|▎         | 62/1818 [00:49<23:10,  1.26it/s, loss=0.719, v_num=77, loss_focal=0.0251, loss_dice=0.279, distill_loss=0.175, acc=0.948, av_BS_IoU=0.716, av_BS_pa=0.927, loss_iou=0.00308, train_per_mask_iou=0.751]Epoch 0:   3%|▎         | 63/1818 [00:49<23:04,  1.27it/s, loss=0.719, v_num=77, loss_focal=0.0251, loss_dice=0.279, distill_loss=0.175, acc=0.948, av_BS_IoU=0.716, av_BS_pa=0.927, loss_iou=0.00308, train_per_mask_iou=0.751]Epoch 0:   3%|▎         | 63/1818 [00:49<23:04,  1.27it/s, loss=0.824, v_num=77, loss_focal=0.00692, loss_dice=0.463, distill_loss=0.178, acc=0.974, av_BS_IoU=0.781, av_BS_pa=0.970, loss_iou=0.023, train_per_mask_iou=0.752] Epoch 0:   4%|▎         | 64/1818 [00:50<22:58,  1.27it/s, loss=0.824, v_num=77, loss_focal=0.00692, loss_dice=0.463, distill_loss=0.178, acc=0.974, av_BS_IoU=0.781, av_BS_pa=0.970, loss_iou=0.023, train_per_mask_iou=0.752]Epoch 0:   4%|▎         | 64/1818 [00:50<22:58,  1.27it/s, loss=0.482, v_num=77, loss_focal=0.000745, loss_dice=0.237, distill_loss=0.176, acc=0.997, av_BS_IoU=0.954, av_BS_pa=0.998, loss_iou=0.0189, train_per_mask_iou=0.754]Epoch 0:   4%|▎         | 65/1818 [00:50<22:52,  1.28it/s, loss=0.482, v_num=77, loss_focal=0.000745, loss_dice=0.237, distill_loss=0.176, acc=0.997, av_BS_IoU=0.954, av_BS_pa=0.998, loss_iou=0.0189, train_per_mask_iou=0.754]Epoch 0:   4%|▎         | 65/1818 [00:50<22:52,  1.28it/s, loss=0.518, v_num=77, loss_focal=0.00729, loss_dice=0.272, distill_loss=0.134, acc=0.990, av_BS_IoU=0.822, av_BS_pa=0.989, loss_iou=0.00256, train_per_mask_iou=0.755]Epoch 0:   4%|▎         | 66/1818 [00:51<22:46,  1.28it/s, loss=0.518, v_num=77, loss_focal=0.00729, loss_dice=0.272, distill_loss=0.134, acc=0.990, av_BS_IoU=0.822, av_BS_pa=0.989, loss_iou=0.00256, train_per_mask_iou=0.755]Epoch 0:   4%|▎         | 66/1818 [00:51<22:46,  1.28it/s, loss=0.620, v_num=77, loss_focal=0.0129, loss_dice=0.215, distill_loss=0.192, acc=0.971, av_BS_IoU=0.670, av_BS_pa=0.964, loss_iou=0.00681, train_per_mask_iou=0.755] Epoch 0:   4%|▎         | 67/1818 [00:56<24:47,  1.18it/s, loss=0.620, v_num=77, loss_focal=0.0129, loss_dice=0.215, distill_loss=0.192, acc=0.971, av_BS_IoU=0.670, av_BS_pa=0.964, loss_iou=0.00681, train_per_mask_iou=0.755]Epoch 0:   4%|▎         | 67/1818 [00:56<24:47,  1.18it/s, loss=0.437, v_num=77, loss_focal=0.00227, loss_dice=0.225, distill_loss=0.122, acc=0.995, av_BS_IoU=0.862, av_BS_pa=0.993, loss_iou=0.0239, train_per_mask_iou=0.757]Epoch 0:   4%|▎         | 68/1818 [00:57<24:42,  1.18it/s, loss=0.437, v_num=77, loss_focal=0.00227, loss_dice=0.225, distill_loss=0.122, acc=0.995, av_BS_IoU=0.862, av_BS_pa=0.993, loss_iou=0.0239, train_per_mask_iou=0.757]Epoch 0:   4%|▎         | 68/1818 [00:57<24:42,  1.18it/s, loss=0.748, v_num=77, loss_focal=0.00632, loss_dice=0.378, distill_loss=0.155, acc=0.330, av_BS_IoU=0.602, av_BS_pa=0.971, loss_iou=0.00273, train_per_mask_iou=0.755]Epoch 0:   4%|▍         | 69/1818 [00:58<24:45,  1.18it/s, loss=0.748, v_num=77, loss_focal=0.00632, loss_dice=0.378, distill_loss=0.155, acc=0.330, av_BS_IoU=0.602, av_BS_pa=0.971, loss_iou=0.00273, train_per_mask_iou=0.755]Epoch 0:   4%|▍         | 69/1818 [00:58<24:45,  1.18it/s, loss=0.281, v_num=77, loss_focal=0.00291, loss_dice=0.0439, distill_loss=0.178, acc=0.994, av_BS_IoU=0.936, av_BS_pa=0.993, loss_iou=8.13e-5, train_per_mask_iou=0.757]Epoch 0:   4%|▍         | 70/1818 [00:59<24:39,  1.18it/s, loss=0.281, v_num=77, loss_focal=0.00291, loss_dice=0.0439, distill_loss=0.178, acc=0.994, av_BS_IoU=0.936, av_BS_pa=0.993, loss_iou=8.13e-5, train_per_mask_iou=0.757]Epoch 0:   4%|▍         | 70/1818 [00:59<24:39,  1.18it/s, loss=0.945, v_num=77, loss_focal=0.0108, loss_dice=0.446, distill_loss=0.180, acc=0.984, av_BS_IoU=0.533, av_BS_pa=0.984, loss_iou=0.00853, train_per_mask_iou=0.755]  Epoch 0:   4%|▍         | 71/1818 [01:01<25:04,  1.16it/s, loss=0.945, v_num=77, loss_focal=0.0108, loss_dice=0.446, distill_loss=0.180, acc=0.984, av_BS_IoU=0.533, av_BS_pa=0.984, loss_iou=0.00853, train_per_mask_iou=0.755]Epoch 0:   4%|▍         | 71/1818 [01:01<25:04,  1.16it/s, loss=0.410, v_num=77, loss_focal=0.00473, loss_dice=0.134, distill_loss=0.180, acc=0.987, av_BS_IoU=0.889, av_BS_pa=0.983, loss_iou=0.0133, train_per_mask_iou=0.757]Epoch 0:   4%|▍         | 72/1818 [01:02<25:12,  1.15it/s, loss=0.410, v_num=77, loss_focal=0.00473, loss_dice=0.134, distill_loss=0.180, acc=0.987, av_BS_IoU=0.889, av_BS_pa=0.983, loss_iou=0.0133, train_per_mask_iou=0.757]Epoch 0:   4%|▍         | 72/1818 [01:02<25:12,  1.15it/s, loss=1.320, v_num=77, loss_focal=0.0102, loss_dice=0.723, distill_loss=0.158, acc=0.487, av_BS_IoU=0.566, av_BS_pa=0.953, loss_iou=0.0718, train_per_mask_iou=0.752] Epoch 0:   4%|▍         | 73/1818 [01:03<25:07,  1.16it/s, loss=1.320, v_num=77, loss_focal=0.0102, loss_dice=0.723, distill_loss=0.158, acc=0.487, av_BS_IoU=0.566, av_BS_pa=0.953, loss_iou=0.0718, train_per_mask_iou=0.752]Epoch 0:   4%|▍         | 73/1818 [01:03<25:07,  1.16it/s, loss=0.260, v_num=77, loss_focal=0.00283, loss_dice=0.0553, distill_loss=0.150, acc=0.498, av_BS_IoU=0.921, av_BS_pa=0.994, loss_iou=0.000904, train_per_mask_iou=0.756]Epoch 0:   4%|▍         | 74/1818 [01:03<25:00,  1.16it/s, loss=0.260, v_num=77, loss_focal=0.00283, loss_dice=0.0553, distill_loss=0.150, acc=0.498, av_BS_IoU=0.921, av_BS_pa=0.994, loss_iou=0.000904, train_per_mask_iou=0.756]Epoch 0:   4%|▍         | 74/1818 [01:03<25:00,  1.16it/s, loss=0.323, v_num=77, loss_focal=0.00372, loss_dice=0.0911, distill_loss=0.157, acc=0.995, av_BS_IoU=0.873, av_BS_pa=0.995, loss_iou=0.00389, train_per_mask_iou=0.758] Epoch 0:   4%|▍         | 75/1818 [01:04<24:53,  1.17it/s, loss=0.323, v_num=77, loss_focal=0.00372, loss_dice=0.0911, distill_loss=0.157, acc=0.995, av_BS_IoU=0.873, av_BS_pa=0.995, loss_iou=0.00389, train_per_mask_iou=0.758]Epoch 0:   4%|▍         | 75/1818 [01:04<24:53,  1.17it/s, loss=0.229, v_num=77, loss_focal=0.00189, loss_dice=0.0484, distill_loss=0.131, acc=0.998, av_BS_IoU=0.925, av_BS_pa=0.998, loss_iou=0.00565, train_per_mask_iou=0.760]Epoch 0:   4%|▍         | 76/1818 [01:04<24:46,  1.17it/s, loss=0.229, v_num=77, loss_focal=0.00189, loss_dice=0.0484, distill_loss=0.131, acc=0.998, av_BS_IoU=0.925, av_BS_pa=0.998, loss_iou=0.00565, train_per_mask_iou=0.760]Epoch 0:   4%|▍         | 76/1818 [01:04<24:47,  1.17it/s, loss=1.920, v_num=77, loss_focal=0.0212, loss_dice=0.744, distill_loss=0.160, acc=0.936, av_BS_IoU=0.137, av_BS_pa=0.939, loss_iou=0.0511, train_per_mask_iou=0.752]   Epoch 0:   4%|▍         | 77/1818 [01:05<24:40,  1.18it/s, loss=1.920, v_num=77, loss_focal=0.0212, loss_dice=0.744, distill_loss=0.160, acc=0.936, av_BS_IoU=0.137, av_BS_pa=0.939, loss_iou=0.0511, train_per_mask_iou=0.752]Epoch 0:   4%|▍         | 77/1818 [01:05<24:40,  1.18it/s, loss=0.650, v_num=77, loss_focal=0.0112, loss_dice=0.288, distill_loss=0.192, acc=0.954, av_BS_IoU=0.786, av_BS_pa=0.962, loss_iou=0.00592, train_per_mask_iou=0.752]Epoch 0:   4%|▍         | 78/1818 [01:07<25:16,  1.15it/s, loss=0.650, v_num=77, loss_focal=0.0112, loss_dice=0.288, distill_loss=0.192, acc=0.954, av_BS_IoU=0.786, av_BS_pa=0.962, loss_iou=0.00592, train_per_mask_iou=0.752]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   4%|▍         | 78/1818 [01:07<25:16,  1.15it/s, loss=0.290, v_num=77, loss_focal=0.00399, loss_dice=0.0803, distill_loss=0.145, acc=0.993, av_BS_IoU=0.897, av_BS_pa=0.991, loss_iou=0.000112, train_per_mask_iou=0.754]Epoch 0:   4%|▍         | 79/1818 [01:08<25:09,  1.15it/s, loss=0.290, v_num=77, loss_focal=0.00399, loss_dice=0.0803, distill_loss=0.145, acc=0.993, av_BS_IoU=0.897, av_BS_pa=0.991, loss_iou=0.000112, train_per_mask_iou=0.754]Epoch 0:   4%|▍         | 79/1818 [01:08<25:09,  1.15it/s, loss=0.353, v_num=77, loss_focal=0.00171, loss_dice=0.117, distill_loss=0.167, acc=0.993, av_BS_IoU=0.943, av_BS_pa=0.993, loss_iou=0.0182, train_per_mask_iou=0.756]   Epoch 0:   4%|▍         | 80/1818 [01:09<25:02,  1.16it/s, loss=0.353, v_num=77, loss_focal=0.00171, loss_dice=0.117, distill_loss=0.167, acc=0.993, av_BS_IoU=0.943, av_BS_pa=0.993, loss_iou=0.0182, train_per_mask_iou=0.756]Epoch 0:   4%|▍         | 80/1818 [01:09<25:02,  1.16it/s, loss=0.452, v_num=77, loss_focal=0.00123, loss_dice=0.195, distill_loss=0.148, acc=0.995, av_BS_IoU=0.930, av_BS_pa=0.994, loss_iou=0.0574, train_per_mask_iou=0.758]Epoch 0:   4%|▍         | 81/1818 [01:09<24:55,  1.16it/s, loss=0.452, v_num=77, loss_focal=0.00123, loss_dice=0.195, distill_loss=0.148, acc=0.995, av_BS_IoU=0.930, av_BS_pa=0.994, loss_iou=0.0574, train_per_mask_iou=0.758]Epoch 0:   4%|▍         | 81/1818 [01:09<24:55,  1.16it/s, loss=0.280, v_num=77, loss_focal=0.00279, loss_dice=0.0599, distill_loss=0.158, acc=0.989, av_BS_IoU=0.948, av_BS_pa=0.989, loss_iou=0.00927, train_per_mask_iou=0.760]Epoch 0:   5%|▍         | 82/1818 [01:10<24:48,  1.17it/s, loss=0.280, v_num=77, loss_focal=0.00279, loss_dice=0.0599, distill_loss=0.158, acc=0.989, av_BS_IoU=0.948, av_BS_pa=0.989, loss_iou=0.00927, train_per_mask_iou=0.760]Epoch 0:   5%|▍         | 82/1818 [01:10<24:48,  1.17it/s, loss=0.259, v_num=77, loss_focal=0.00227, loss_dice=0.0547, distill_loss=0.152, acc=0.995, av_BS_IoU=0.939, av_BS_pa=0.993, loss_iou=0.00271, train_per_mask_iou=0.762]Epoch 0:   5%|▍         | 83/1818 [01:11<24:44,  1.17it/s, loss=0.259, v_num=77, loss_focal=0.00227, loss_dice=0.0547, distill_loss=0.152, acc=0.995, av_BS_IoU=0.939, av_BS_pa=0.993, loss_iou=0.00271, train_per_mask_iou=0.762]Epoch 0:   5%|▍         | 83/1818 [01:11<24:44,  1.17it/s, loss=0.402, v_num=77, loss_focal=0.000914, loss_dice=0.198, distill_loss=0.128, acc=0.499, av_BS_IoU=0.877, av_BS_pa=0.998, loss_iou=0.0215, train_per_mask_iou=0.764] Epoch 0:   5%|▍         | 84/1818 [01:12<24:48,  1.17it/s, loss=0.402, v_num=77, loss_focal=0.000914, loss_dice=0.198, distill_loss=0.128, acc=0.499, av_BS_IoU=0.877, av_BS_pa=0.998, loss_iou=0.0215, train_per_mask_iou=0.764]Epoch 0:   5%|▍         | 84/1818 [01:12<24:48,  1.17it/s, loss=0.592, v_num=77, loss_focal=0.00155, loss_dice=0.257, distill_loss=0.169, acc=0.166, av_BS_IoU=0.619, av_BS_pa=0.999, loss_iou=0.011, train_per_mask_iou=0.756]  Epoch 0:   5%|▍         | 85/1818 [01:12<24:43,  1.17it/s, loss=0.592, v_num=77, loss_focal=0.00155, loss_dice=0.257, distill_loss=0.169, acc=0.166, av_BS_IoU=0.619, av_BS_pa=0.999, loss_iou=0.011, train_per_mask_iou=0.756]Epoch 0:   5%|▍         | 85/1818 [01:12<24:43,  1.17it/s, loss=0.485, v_num=77, loss_focal=0.0017, loss_dice=0.208, distill_loss=0.161, acc=0.994, av_BS_IoU=0.860, av_BS_pa=0.994, loss_iou=0.041, train_per_mask_iou=0.757] Epoch 0:   5%|▍         | 86/1818 [01:13<24:36,  1.17it/s, loss=0.485, v_num=77, loss_focal=0.0017, loss_dice=0.208, distill_loss=0.161, acc=0.994, av_BS_IoU=0.860, av_BS_pa=0.994, loss_iou=0.041, train_per_mask_iou=0.757]Epoch 0:   5%|▍         | 86/1818 [01:13<24:36,  1.17it/s, loss=4.390, v_num=77, loss_focal=0.287, loss_dice=0.640, distill_loss=0.135, acc=0.828, av_BS_IoU=0.192, av_BS_pa=0.827, loss_iou=0.384, train_per_mask_iou=0.752] Epoch 0:   5%|▍         | 87/1818 [01:13<24:30,  1.18it/s, loss=4.390, v_num=77, loss_focal=0.287, loss_dice=0.640, distill_loss=0.135, acc=0.828, av_BS_IoU=0.192, av_BS_pa=0.827, loss_iou=0.384, train_per_mask_iou=0.752]Epoch 0:   5%|▍         | 87/1818 [01:13<24:30,  1.18it/s, loss=0.262, v_num=77, loss_focal=0.00134, loss_dice=0.0586, distill_loss=0.152, acc=0.994, av_BS_IoU=0.937, av_BS_pa=0.996, loss_iou=0.00531, train_per_mask_iou=0.753]Epoch 0:   5%|▍         | 88/1818 [01:14<24:32,  1.17it/s, loss=0.262, v_num=77, loss_focal=0.00134, loss_dice=0.0586, distill_loss=0.152, acc=0.994, av_BS_IoU=0.937, av_BS_pa=0.996, loss_iou=0.00531, train_per_mask_iou=0.753]Epoch 0:   5%|▍         | 88/1818 [01:14<24:32,  1.17it/s, loss=0.996, v_num=77, loss_focal=0.00215, loss_dice=0.565, distill_loss=0.205, acc=0.497, av_BS_IoU=0.932, av_BS_pa=0.996, loss_iou=0.140, train_per_mask_iou=0.756]   Epoch 0:   5%|▍         | 89/1818 [01:15<24:26,  1.18it/s, loss=0.996, v_num=77, loss_focal=0.00215, loss_dice=0.565, distill_loss=0.205, acc=0.497, av_BS_IoU=0.932, av_BS_pa=0.996, loss_iou=0.140, train_per_mask_iou=0.756]Epoch 0:   5%|▍         | 89/1818 [01:15<24:26,  1.18it/s, loss=0.460, v_num=77, loss_focal=0.000865, loss_dice=0.130, distill_loss=0.223, acc=0.999, av_BS_IoU=0.782, av_BS_pa=0.999, loss_iou=0.00785, train_per_mask_iou=0.756]Epoch 0:   5%|▍         | 90/1818 [01:16<24:21,  1.18it/s, loss=0.460, v_num=77, loss_focal=0.000865, loss_dice=0.130, distill_loss=0.223, acc=0.999, av_BS_IoU=0.782, av_BS_pa=0.999, loss_iou=0.00785, train_per_mask_iou=0.756]Epoch 0:   5%|▍         | 90/1818 [01:16<24:21,  1.18it/s, loss=0.224, v_num=77, loss_focal=0.00162, loss_dice=0.0204, distill_loss=0.159, acc=0.996, av_BS_IoU=0.967, av_BS_pa=0.995, loss_iou=0.000108, train_per_mask_iou=0.758]Epoch 0:   5%|▌         | 91/1818 [01:16<24:14,  1.19it/s, loss=0.224, v_num=77, loss_focal=0.00162, loss_dice=0.0204, distill_loss=0.159, acc=0.996, av_BS_IoU=0.967, av_BS_pa=0.995, loss_iou=0.000108, train_per_mask_iou=0.758]Epoch 0:   5%|▌         | 91/1818 [01:16<24:14,  1.19it/s, loss=0.654, v_num=77, loss_focal=0.0103, loss_dice=0.293, distill_loss=0.159, acc=0.990, av_BS_IoU=0.640, av_BS_pa=0.989, loss_iou=0.00107, train_per_mask_iou=0.757]   Epoch 0:   5%|▌         | 92/1818 [01:17<24:08,  1.19it/s, loss=0.654, v_num=77, loss_focal=0.0103, loss_dice=0.293, distill_loss=0.159, acc=0.990, av_BS_IoU=0.640, av_BS_pa=0.989, loss_iou=0.00107, train_per_mask_iou=0.757]Epoch 0:   5%|▌         | 92/1818 [01:17<24:08,  1.19it/s, loss=0.385, v_num=77, loss_focal=0.00968, loss_dice=0.107, distill_loss=0.162, acc=0.982, av_BS_IoU=0.832, av_BS_pa=0.978, loss_iou=0.00266, train_per_mask_iou=0.758]Epoch 0:   5%|▌         | 93/1818 [01:17<24:03,  1.20it/s, loss=0.385, v_num=77, loss_focal=0.00968, loss_dice=0.107, distill_loss=0.162, acc=0.982, av_BS_IoU=0.832, av_BS_pa=0.978, loss_iou=0.00266, train_per_mask_iou=0.758]Epoch 0:   5%|▌         | 93/1818 [01:17<24:03,  1.20it/s, loss=0.804, v_num=77, loss_focal=0.0317, loss_dice=0.283, distill_loss=0.159, acc=0.879, av_BS_IoU=0.603, av_BS_pa=0.845, loss_iou=0.0127, train_per_mask_iou=0.757]  Epoch 0:   5%|▌         | 94/1818 [01:18<24:05,  1.19it/s, loss=0.804, v_num=77, loss_focal=0.0317, loss_dice=0.283, distill_loss=0.159, acc=0.879, av_BS_IoU=0.603, av_BS_pa=0.845, loss_iou=0.0127, train_per_mask_iou=0.757]Epoch 0:   5%|▌         | 94/1818 [01:18<24:05,  1.19it/s, loss=0.349, v_num=77, loss_focal=0.00238, loss_dice=0.155, distill_loss=0.135, acc=0.988, av_BS_IoU=0.901, av_BS_pa=0.990, loss_iou=0.00258, train_per_mask_iou=0.758]Epoch 0:   5%|▌         | 95/1818 [01:19<24:08,  1.19it/s, loss=0.349, v_num=77, loss_focal=0.00238, loss_dice=0.155, distill_loss=0.135, acc=0.988, av_BS_IoU=0.901, av_BS_pa=0.990, loss_iou=0.00258, train_per_mask_iou=0.758]Epoch 0:   5%|▌         | 95/1818 [01:19<24:08,  1.19it/s, loss=0.356, v_num=77, loss_focal=0.00199, loss_dice=0.094, distill_loss=0.185, acc=0.998, av_BS_IoU=0.837, av_BS_pa=0.998, loss_iou=0.000902, train_per_mask_iou=0.759]Epoch 0:   5%|▌         | 96/1818 [01:22<24:33,  1.17it/s, loss=0.356, v_num=77, loss_focal=0.00199, loss_dice=0.094, distill_loss=0.185, acc=0.998, av_BS_IoU=0.837, av_BS_pa=0.998, loss_iou=0.000902, train_per_mask_iou=0.759]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   5%|▌         | 96/1818 [01:22<24:33,  1.17it/s, loss=0.919, v_num=77, loss_focal=0.00386, loss_dice=0.475, distill_loss=0.160, acc=0.0766, av_BS_IoU=0.596, av_BS_pa=0.986, loss_iou=0.0472, train_per_mask_iou=0.749] Epoch 0:   5%|▌         | 97/1818 [01:22<24:28,  1.17it/s, loss=0.919, v_num=77, loss_focal=0.00386, loss_dice=0.475, distill_loss=0.160, acc=0.0766, av_BS_IoU=0.596, av_BS_pa=0.986, loss_iou=0.0472, train_per_mask_iou=0.749]Epoch 0:   5%|▌         | 97/1818 [01:22<24:28,  1.17it/s, loss=0.520, v_num=77, loss_focal=0.00177, loss_dice=0.176, distill_loss=0.215, acc=0.998, av_BS_IoU=0.720, av_BS_pa=0.998, loss_iou=0.00367, train_per_mask_iou=0.749]Epoch 0:   5%|▌         | 98/1818 [01:23<24:25,  1.17it/s, loss=0.520, v_num=77, loss_focal=0.00177, loss_dice=0.176, distill_loss=0.215, acc=0.998, av_BS_IoU=0.720, av_BS_pa=0.998, loss_iou=0.00367, train_per_mask_iou=0.749]Epoch 0:   5%|▌         | 98/1818 [01:23<24:25,  1.17it/s, loss=0.377, v_num=77, loss_focal=0.00225, loss_dice=0.171, distill_loss=0.120, acc=0.249, av_BS_IoU=0.842, av_BS_pa=0.997, loss_iou=0.0218, train_per_mask_iou=0.752] Epoch 0:   5%|▌         | 99/1818 [01:24<24:20,  1.18it/s, loss=0.377, v_num=77, loss_focal=0.00225, loss_dice=0.171, distill_loss=0.120, acc=0.249, av_BS_IoU=0.842, av_BS_pa=0.997, loss_iou=0.0218, train_per_mask_iou=0.752]Epoch 0:   5%|▌         | 99/1818 [01:24<24:20,  1.18it/s, loss=0.370, v_num=77, loss_focal=0.000261, loss_dice=0.167, distill_loss=0.134, acc=1.000, av_BS_IoU=0.786, av_BS_pa=1.000, loss_iou=0.00235, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 100/1818 [01:24<24:15,  1.18it/s, loss=0.370, v_num=77, loss_focal=0.000261, loss_dice=0.167, distill_loss=0.134, acc=1.000, av_BS_IoU=0.786, av_BS_pa=1.000, loss_iou=0.00235, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 100/1818 [01:24<24:15,  1.18it/s, loss=0.403, v_num=77, loss_focal=0.000539, loss_dice=0.0656, distill_loss=0.255, acc=0.999, av_BS_IoU=0.893, av_BS_pa=0.999, loss_iou=0.00641, train_per_mask_iou=0.753]Epoch 0:   6%|▌         | 101/1818 [01:25<24:19,  1.18it/s, loss=0.403, v_num=77, loss_focal=0.000539, loss_dice=0.0656, distill_loss=0.255, acc=0.999, av_BS_IoU=0.893, av_BS_pa=0.999, loss_iou=0.00641, train_per_mask_iou=0.753]Epoch 0:   6%|▌         | 101/1818 [01:25<24:19,  1.18it/s, loss=0.757, v_num=77, loss_focal=0.00676, loss_dice=0.446, distill_loss=0.170, acc=0.957, av_BS_IoU=0.806, av_BS_pa=0.974, loss_iou=0.000133, train_per_mask_iou=0.752] Epoch 0:   6%|▌         | 102/1818 [01:26<24:13,  1.18it/s, loss=0.757, v_num=77, loss_focal=0.00676, loss_dice=0.446, distill_loss=0.170, acc=0.957, av_BS_IoU=0.806, av_BS_pa=0.974, loss_iou=0.000133, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 102/1818 [01:26<24:13,  1.18it/s, loss=0.462, v_num=77, loss_focal=0.00201, loss_dice=0.158, distill_loss=0.192, acc=0.999, av_BS_IoU=0.725, av_BS_pa=0.999, loss_iou=0.000249, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 103/1818 [01:27<24:14,  1.18it/s, loss=0.462, v_num=77, loss_focal=0.00201, loss_dice=0.158, distill_loss=0.192, acc=0.999, av_BS_IoU=0.725, av_BS_pa=0.999, loss_iou=0.000249, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 103/1818 [01:27<24:14,  1.18it/s, loss=0.431, v_num=77, loss_focal=0.00206, loss_dice=0.194, distill_loss=0.136, acc=0.999, av_BS_IoU=0.708, av_BS_pa=0.999, loss_iou=0.000348, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 104/1818 [01:27<24:09,  1.18it/s, loss=0.431, v_num=77, loss_focal=0.00206, loss_dice=0.194, distill_loss=0.136, acc=0.999, av_BS_IoU=0.708, av_BS_pa=0.999, loss_iou=0.000348, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 104/1818 [01:27<24:09,  1.18it/s, loss=0.248, v_num=77, loss_focal=0.00139, loss_dice=0.0389, distill_loss=0.163, acc=0.997, av_BS_IoU=0.944, av_BS_pa=0.997, loss_iou=0.000357, train_per_mask_iou=0.753]Epoch 0:   6%|▌         | 105/1818 [01:31<24:51,  1.15it/s, loss=0.248, v_num=77, loss_focal=0.00139, loss_dice=0.0389, distill_loss=0.163, acc=0.997, av_BS_IoU=0.944, av_BS_pa=0.997, loss_iou=0.000357, train_per_mask_iou=0.753]Epoch 0:   6%|▌         | 105/1818 [01:31<24:52,  1.15it/s, loss=0.229, v_num=77, loss_focal=0.00166, loss_dice=0.0543, distill_loss=0.130, acc=0.997, av_BS_IoU=0.917, av_BS_pa=0.997, loss_iou=0.00135, train_per_mask_iou=0.754] Epoch 0:   6%|▌         | 106/1818 [01:32<25:00,  1.14it/s, loss=0.229, v_num=77, loss_focal=0.00166, loss_dice=0.0543, distill_loss=0.130, acc=0.997, av_BS_IoU=0.917, av_BS_pa=0.997, loss_iou=0.00135, train_per_mask_iou=0.754]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   6%|▌         | 106/1818 [01:32<25:00,  1.14it/s, loss=1.470, v_num=77, loss_focal=0.0393, loss_dice=0.449, distill_loss=0.176, acc=0.758, av_BS_IoU=0.316, av_BS_pa=0.781, loss_iou=0.112, train_per_mask_iou=0.750]    Epoch 0:   6%|▌         | 107/1818 [01:33<24:54,  1.14it/s, loss=1.470, v_num=77, loss_focal=0.0393, loss_dice=0.449, distill_loss=0.176, acc=0.758, av_BS_IoU=0.316, av_BS_pa=0.781, loss_iou=0.112, train_per_mask_iou=0.750]Epoch 0:   6%|▌         | 107/1818 [01:33<24:54,  1.14it/s, loss=0.318, v_num=77, loss_focal=0.0024, loss_dice=0.0847, distill_loss=0.168, acc=0.994, av_BS_IoU=0.885, av_BS_pa=0.993, loss_iou=0.00207, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 108/1818 [01:34<24:52,  1.15it/s, loss=0.318, v_num=77, loss_focal=0.0024, loss_dice=0.0847, distill_loss=0.168, acc=0.994, av_BS_IoU=0.885, av_BS_pa=0.993, loss_iou=0.00207, train_per_mask_iou=0.752]Epoch 0:   6%|▌         | 108/1818 [01:34<24:53,  1.15it/s, loss=0.455, v_num=77, loss_focal=0.00476, loss_dice=0.132, distill_loss=0.224, acc=0.986, av_BS_IoU=0.875, av_BS_pa=0.980, loss_iou=0.0018, train_per_mask_iou=0.753] Epoch 0:   6%|▌         | 109/1818 [01:35<24:55,  1.14it/s, loss=0.455, v_num=77, loss_focal=0.00476, loss_dice=0.132, distill_loss=0.224, acc=0.986, av_BS_IoU=0.875, av_BS_pa=0.980, loss_iou=0.0018, train_per_mask_iou=0.753]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   6%|▌         | 109/1818 [01:35<24:55,  1.14it/s, loss=0.708, v_num=77, loss_focal=0.00182, loss_dice=0.258, distill_loss=0.171, acc=0.992, av_BS_IoU=0.934, av_BS_pa=0.993, loss_iou=0.213, train_per_mask_iou=0.754] Epoch 0:   6%|▌         | 110/1818 [01:36<24:51,  1.15it/s, loss=0.708, v_num=77, loss_focal=0.00182, loss_dice=0.258, distill_loss=0.171, acc=0.992, av_BS_IoU=0.934, av_BS_pa=0.993, loss_iou=0.213, train_per_mask_iou=0.754]Epoch 0:   6%|▌         | 110/1818 [01:36<24:51,  1.15it/s, loss=0.436, v_num=77, loss_focal=0.00177, loss_dice=0.157, distill_loss=0.131, acc=0.993, av_BS_IoU=0.960, av_BS_pa=0.994, loss_iou=0.103, train_per_mask_iou=0.755]Epoch 0:   6%|▌         | 111/1818 [01:37<24:52,  1.14it/s, loss=0.436, v_num=77, loss_focal=0.00177, loss_dice=0.157, distill_loss=0.131, acc=0.993, av_BS_IoU=0.960, av_BS_pa=0.994, loss_iou=0.103, train_per_mask_iou=0.755]Epoch 0:   6%|▌         | 111/1818 [01:37<24:52,  1.14it/s, loss=0.286, v_num=77, loss_focal=0.000781, loss_dice=0.0592, distill_loss=0.171, acc=0.998, av_BS_IoU=0.911, av_BS_pa=0.998, loss_iou=0.00462, train_per_mask_iou=0.756]Epoch 0:   6%|▌         | 112/1818 [01:37<24:47,  1.15it/s, loss=0.286, v_num=77, loss_focal=0.000781, loss_dice=0.0592, distill_loss=0.171, acc=0.998, av_BS_IoU=0.911, av_BS_pa=0.998, loss_iou=0.00462, train_per_mask_iou=0.756]Epoch 0:   6%|▌         | 112/1818 [01:37<24:47,  1.15it/s, loss=0.421, v_num=77, loss_focal=0.00155, loss_dice=0.140, distill_loss=0.181, acc=0.992, av_BS_IoU=0.870, av_BS_pa=0.994, loss_iou=0.0284, train_per_mask_iou=0.757]   Epoch 0:   6%|▌         | 113/1818 [01:38<24:51,  1.14it/s, loss=0.421, v_num=77, loss_focal=0.00155, loss_dice=0.140, distill_loss=0.181, acc=0.992, av_BS_IoU=0.870, av_BS_pa=0.994, loss_iou=0.0284, train_per_mask_iou=0.757]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   6%|▌         | 113/1818 [01:38<24:51,  1.14it/s, loss=0.531, v_num=77, loss_focal=0.0196, loss_dice=0.197, distill_loss=0.148, acc=0.983, av_BS_IoU=0.783, av_BS_pa=0.983, loss_iou=0.000485, train_per_mask_iou=0.757]Epoch 0:   6%|▋         | 114/1818 [01:39<24:46,  1.15it/s, loss=0.531, v_num=77, loss_focal=0.0196, loss_dice=0.197, distill_loss=0.148, acc=0.983, av_BS_IoU=0.783, av_BS_pa=0.983, loss_iou=0.000485, train_per_mask_iou=0.757]Epoch 0:   6%|▋         | 114/1818 [01:39<24:46,  1.15it/s, loss=1.100, v_num=77, loss_focal=0.0535, loss_dice=0.277, distill_loss=0.155, acc=0.673, av_BS_IoU=0.445, av_BS_pa=0.687, loss_iou=0.0619, train_per_mask_iou=0.755]  Epoch 0:   6%|▋         | 115/1818 [01:40<24:41,  1.15it/s, loss=1.100, v_num=77, loss_focal=0.0535, loss_dice=0.277, distill_loss=0.155, acc=0.673, av_BS_IoU=0.445, av_BS_pa=0.687, loss_iou=0.0619, train_per_mask_iou=0.755]Epoch 0:   6%|▋         | 115/1818 [01:40<24:41,  1.15it/s, loss=0.415, v_num=77, loss_focal=0.000831, loss_dice=0.183, distill_loss=0.159, acc=0.997, av_BS_IoU=0.963, av_BS_pa=0.997, loss_iou=0.0299, train_per_mask_iou=0.756]Epoch 0:   6%|▋         | 116/1818 [01:40<24:36,  1.15it/s, loss=0.415, v_num=77, loss_focal=0.000831, loss_dice=0.183, distill_loss=0.159, acc=0.997, av_BS_IoU=0.963, av_BS_pa=0.997, loss_iou=0.0299, train_per_mask_iou=0.756]Epoch 0:   6%|▋         | 116/1818 [01:40<24:36,  1.15it/s, loss=1.650, v_num=77, loss_focal=0.0349, loss_dice=0.545, distill_loss=0.161, acc=0.779, av_BS_IoU=0.133, av_BS_pa=0.786, loss_iou=0.023, train_per_mask_iou=0.751]   Epoch 0:   6%|▋         | 117/1818 [01:41<24:30,  1.16it/s, loss=1.650, v_num=77, loss_focal=0.0349, loss_dice=0.545, distill_loss=0.161, acc=0.779, av_BS_IoU=0.133, av_BS_pa=0.786, loss_iou=0.023, train_per_mask_iou=0.751]Epoch 0:   6%|▋         | 117/1818 [01:41<24:30,  1.16it/s, loss=1.490, v_num=77, loss_focal=0.00591, loss_dice=0.757, distill_loss=0.157, acc=0.989, av_BS_IoU=0.537, av_BS_pa=0.975, loss_iou=0.169, train_per_mask_iou=0.751]Epoch 0:   6%|▋         | 118/1818 [01:42<24:31,  1.16it/s, loss=1.490, v_num=77, loss_focal=0.00591, loss_dice=0.757, distill_loss=0.157, acc=0.989, av_BS_IoU=0.537, av_BS_pa=0.975, loss_iou=0.169, train_per_mask_iou=0.751]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   6%|▋         | 118/1818 [01:42<24:31,  1.16it/s, loss=0.365, v_num=77, loss_focal=0.00206, loss_dice=0.117, distill_loss=0.166, acc=0.998, av_BS_IoU=0.798, av_BS_pa=0.997, loss_iou=0.00196, train_per_mask_iou=0.751]Epoch 0:   7%|▋         | 119/1818 [01:42<24:25,  1.16it/s, loss=0.365, v_num=77, loss_focal=0.00206, loss_dice=0.117, distill_loss=0.166, acc=0.998, av_BS_IoU=0.798, av_BS_pa=0.997, loss_iou=0.00196, train_per_mask_iou=0.751]Epoch 0:   7%|▋         | 119/1818 [01:42<24:25,  1.16it/s, loss=0.739, v_num=77, loss_focal=0.0212, loss_dice=0.346, distill_loss=0.143, acc=0.851, av_BS_IoU=0.701, av_BS_pa=0.927, loss_iou=0.00472, train_per_mask_iou=0.749] Epoch 0:   7%|▋         | 120/1818 [01:43<24:21,  1.16it/s, loss=0.739, v_num=77, loss_focal=0.0212, loss_dice=0.346, distill_loss=0.143, acc=0.851, av_BS_IoU=0.701, av_BS_pa=0.927, loss_iou=0.00472, train_per_mask_iou=0.749]Epoch 0:   7%|▋         | 120/1818 [01:43<24:21,  1.16it/s, loss=0.312, v_num=77, loss_focal=0.00228, loss_dice=0.102, distill_loss=0.154, acc=0.992, av_BS_IoU=0.949, av_BS_pa=0.991, loss_iou=0.00569, train_per_mask_iou=0.750]Epoch 0:   7%|▋         | 121/1818 [01:43<24:18,  1.16it/s, loss=0.312, v_num=77, loss_focal=0.00228, loss_dice=0.102, distill_loss=0.154, acc=0.992, av_BS_IoU=0.949, av_BS_pa=0.991, loss_iou=0.00569, train_per_mask_iou=0.750]Epoch 0:   7%|▋         | 121/1818 [01:43<24:18,  1.16it/s, loss=0.263, v_num=77, loss_focal=0.000615, loss_dice=0.0587, distill_loss=0.158, acc=0.998, av_BS_IoU=0.960, av_BS_pa=0.997, loss_iou=0.00649, train_per_mask_iou=0.752]Epoch 0:   7%|▋         | 122/1818 [01:44<24:16,  1.16it/s, loss=0.263, v_num=77, loss_focal=0.000615, loss_dice=0.0587, distill_loss=0.158, acc=0.998, av_BS_IoU=0.960, av_BS_pa=0.997, loss_iou=0.00649, train_per_mask_iou=0.752]Epoch 0:   7%|▋         | 122/1818 [01:44<24:16,  1.16it/s, loss=0.462, v_num=77, loss_focal=0.018, loss_dice=0.0895, distill_loss=0.208, acc=0.984, av_BS_IoU=0.860, av_BS_pa=0.984, loss_iou=0.00026, train_per_mask_iou=0.752]   Epoch 0:   7%|▋         | 123/1818 [01:45<24:16,  1.16it/s, loss=0.462, v_num=77, loss_focal=0.018, loss_dice=0.0895, distill_loss=0.208, acc=0.984, av_BS_IoU=0.860, av_BS_pa=0.984, loss_iou=0.00026, train_per_mask_iou=0.752]Epoch 0:   7%|▋         | 123/1818 [01:45<24:16,  1.16it/s, loss=0.998, v_num=77, loss_focal=0.0124, loss_dice=0.489, distill_loss=0.178, acc=0.489, av_BS_IoU=0.622, av_BS_pa=0.909, loss_iou=0.0448, train_per_mask_iou=0.753] Epoch 0:   7%|▋         | 124/1818 [01:46<24:17,  1.16it/s, loss=0.998, v_num=77, loss_focal=0.0124, loss_dice=0.489, distill_loss=0.178, acc=0.489, av_BS_IoU=0.622, av_BS_pa=0.909, loss_iou=0.0448, train_per_mask_iou=0.753]Epoch 0:   7%|▋         | 124/1818 [01:46<24:17,  1.16it/s, loss=1.700, v_num=77, loss_focal=0.0231, loss_dice=0.778, distill_loss=0.158, acc=0.957, av_BS_IoU=0.281, av_BS_pa=0.910, loss_iou=0.00852, train_per_mask_iou=0.751]Epoch 0:   7%|▋         | 125/1818 [01:47<24:22,  1.16it/s, loss=1.700, v_num=77, loss_focal=0.0231, loss_dice=0.778, distill_loss=0.158, acc=0.957, av_BS_IoU=0.281, av_BS_pa=0.910, loss_iou=0.00852, train_per_mask_iou=0.751]Epoch 0:   7%|▋         | 125/1818 [01:47<24:22,  1.16it/s, loss=0.293, v_num=77, loss_focal=0.000823, loss_dice=0.100, distill_loss=0.133, acc=0.998, av_BS_IoU=0.879, av_BS_pa=0.998, loss_iou=0.0119, train_per_mask_iou=0.752]Epoch 0:   7%|▋         | 126/1818 [01:48<24:23,  1.16it/s, loss=0.293, v_num=77, loss_focal=0.000823, loss_dice=0.100, distill_loss=0.133, acc=0.998, av_BS_IoU=0.879, av_BS_pa=0.998, loss_iou=0.0119, train_per_mask_iou=0.752]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   7%|▋         | 126/1818 [01:48<24:23,  1.16it/s, loss=0.448, v_num=77, loss_focal=0.0148, loss_dice=0.145, distill_loss=0.159, acc=0.970, av_BS_IoU=0.852, av_BS_pa=0.974, loss_iou=0.00513, train_per_mask_iou=0.753] Epoch 0:   7%|▋         | 127/1818 [01:49<24:18,  1.16it/s, loss=0.448, v_num=77, loss_focal=0.0148, loss_dice=0.145, distill_loss=0.159, acc=0.970, av_BS_IoU=0.852, av_BS_pa=0.974, loss_iou=0.00513, train_per_mask_iou=0.753]Epoch 0:   7%|▋         | 127/1818 [01:49<24:18,  1.16it/s, loss=0.450, v_num=77, loss_focal=0.000853, loss_dice=0.141, distill_loss=0.150, acc=0.498, av_BS_IoU=0.873, av_BS_pa=0.997, loss_iou=0.096, train_per_mask_iou=0.754]Epoch 0:   7%|▋         | 128/1818 [01:50<24:13,  1.16it/s, loss=0.450, v_num=77, loss_focal=0.000853, loss_dice=0.141, distill_loss=0.150, acc=0.498, av_BS_IoU=0.873, av_BS_pa=0.997, loss_iou=0.096, train_per_mask_iou=0.754]Epoch 0:   7%|▋         | 128/1818 [01:50<24:13,  1.16it/s, loss=0.460, v_num=77, loss_focal=0.00127, loss_dice=0.198, distill_loss=0.149, acc=0.996, av_BS_IoU=0.935, av_BS_pa=0.995, loss_iou=0.0617, train_per_mask_iou=0.755]Epoch 0:   7%|▋         | 129/1818 [01:50<24:09,  1.17it/s, loss=0.460, v_num=77, loss_focal=0.00127, loss_dice=0.198, distill_loss=0.149, acc=0.996, av_BS_IoU=0.935, av_BS_pa=0.995, loss_iou=0.0617, train_per_mask_iou=0.755]Epoch 0:   7%|▋         | 129/1818 [01:50<24:09,  1.17it/s, loss=0.518, v_num=77, loss_focal=0.0178, loss_dice=0.171, distill_loss=0.166, acc=0.948, av_BS_IoU=0.780, av_BS_pa=0.948, loss_iou=0.00268, train_per_mask_iou=0.755]Epoch 0:   7%|▋         | 130/1818 [01:51<24:05,  1.17it/s, loss=0.518, v_num=77, loss_focal=0.0178, loss_dice=0.171, distill_loss=0.166, acc=0.948, av_BS_IoU=0.780, av_BS_pa=0.948, loss_iou=0.00268, train_per_mask_iou=0.755]Epoch 0:   7%|▋         | 130/1818 [01:51<24:05,  1.17it/s, loss=1.150, v_num=77, loss_focal=0.0107, loss_dice=0.654, distill_loss=0.172, acc=0.980, av_BS_IoU=0.617, av_BS_pa=0.980, loss_iou=0.0151, train_per_mask_iou=0.754] Epoch 0:   7%|▋         | 131/1818 [01:51<24:00,  1.17it/s, loss=1.150, v_num=77, loss_focal=0.0107, loss_dice=0.654, distill_loss=0.172, acc=0.980, av_BS_IoU=0.617, av_BS_pa=0.980, loss_iou=0.0151, train_per_mask_iou=0.754]Epoch 0:   7%|▋         | 131/1818 [01:51<24:00,  1.17it/s, loss=0.556, v_num=77, loss_focal=0.00284, loss_dice=0.290, distill_loss=0.139, acc=0.995, av_BS_IoU=0.738, av_BS_pa=0.995, loss_iou=0.013, train_per_mask_iou=0.754]Epoch 0:   7%|▋         | 132/1818 [01:52<23:55,  1.17it/s, loss=0.556, v_num=77, loss_focal=0.00284, loss_dice=0.290, distill_loss=0.139, acc=0.995, av_BS_IoU=0.738, av_BS_pa=0.995, loss_iou=0.013, train_per_mask_iou=0.754]Epoch 0:   7%|▋         | 132/1818 [01:52<23:55,  1.17it/s, loss=1.660, v_num=77, loss_focal=0.00785, loss_dice=0.845, distill_loss=0.179, acc=0.979, av_BS_IoU=0.333, av_BS_pa=0.964, loss_iou=0.00814, train_per_mask_iou=0.752]Epoch 0:   7%|▋         | 133/1818 [01:53<23:52,  1.18it/s, loss=1.660, v_num=77, loss_focal=0.00785, loss_dice=0.845, distill_loss=0.179, acc=0.979, av_BS_IoU=0.333, av_BS_pa=0.964, loss_iou=0.00814, train_per_mask_iou=0.752]Epoch 0:   7%|▋         | 133/1818 [01:53<23:52,  1.18it/s, loss=0.291, v_num=77, loss_focal=0.000913, loss_dice=0.0842, distill_loss=0.140, acc=0.333, av_BS_IoU=0.911, av_BS_pa=0.997, loss_iou=0.022, train_per_mask_iou=0.755]Epoch 0:   7%|▋         | 134/1818 [01:54<23:57,  1.17it/s, loss=0.291, v_num=77, loss_focal=0.000913, loss_dice=0.0842, distill_loss=0.140, acc=0.333, av_BS_IoU=0.911, av_BS_pa=0.997, loss_iou=0.022, train_per_mask_iou=0.755]Epoch 0:   7%|▋         | 134/1818 [01:54<23:57,  1.17it/s, loss=0.696, v_num=77, loss_focal=0.00976, loss_dice=0.308, distill_loss=0.174, acc=0.0986, av_BS_IoU=0.744, av_BS_pa=0.974, loss_iou=0.0413, train_per_mask_iou=0.756]Epoch 0:   7%|▋         | 135/1818 [01:54<23:53,  1.17it/s, loss=0.696, v_num=77, loss_focal=0.00976, loss_dice=0.308, distill_loss=0.174, acc=0.0986, av_BS_IoU=0.744, av_BS_pa=0.974, loss_iou=0.0413, train_per_mask_iou=0.756]Epoch 0:   7%|▋         | 135/1818 [01:54<23:53,  1.17it/s, loss=0.492, v_num=77, loss_focal=0.00742, loss_dice=0.218, distill_loss=0.163, acc=0.973, av_BS_IoU=0.877, av_BS_pa=0.973, loss_iou=0.0116, train_per_mask_iou=0.757] Epoch 0:   7%|▋         | 136/1818 [01:55<23:49,  1.18it/s, loss=0.492, v_num=77, loss_focal=0.00742, loss_dice=0.218, distill_loss=0.163, acc=0.973, av_BS_IoU=0.877, av_BS_pa=0.973, loss_iou=0.0116, train_per_mask_iou=0.757]Epoch 0:   7%|▋         | 136/1818 [01:55<23:49,  1.18it/s, loss=0.374, v_num=77, loss_focal=0.00741, loss_dice=0.101, distill_loss=0.166, acc=0.984, av_BS_IoU=0.863, av_BS_pa=0.980, loss_iou=0.0107, train_per_mask_iou=0.758]Epoch 0:   8%|▊         | 137/1818 [01:56<23:51,  1.17it/s, loss=0.374, v_num=77, loss_focal=0.00741, loss_dice=0.101, distill_loss=0.166, acc=0.984, av_BS_IoU=0.863, av_BS_pa=0.980, loss_iou=0.0107, train_per_mask_iou=0.758]Epoch 0:   8%|▊         | 137/1818 [01:56<23:51,  1.17it/s, loss=0.578, v_num=77, loss_focal=0.00942, loss_dice=0.278, distill_loss=0.172, acc=0.879, av_BS_IoU=0.941, av_BS_pa=0.980, loss_iou=0.0284, train_per_mask_iou=0.757]Epoch 0:   8%|▊         | 138/1818 [01:57<23:48,  1.18it/s, loss=0.578, v_num=77, loss_focal=0.00942, loss_dice=0.278, distill_loss=0.172, acc=0.879, av_BS_IoU=0.941, av_BS_pa=0.980, loss_iou=0.0284, train_per_mask_iou=0.757]Epoch 0:   8%|▊         | 138/1818 [01:57<23:48,  1.18it/s, loss=0.836, v_num=77, loss_focal=0.00348, loss_dice=0.474, distill_loss=0.164, acc=0.985, av_BS_IoU=0.940, av_BS_pa=0.993, loss_iou=0.122, train_per_mask_iou=0.757] Epoch 0:   8%|▊         | 139/1818 [01:57<23:44,  1.18it/s, loss=0.836, v_num=77, loss_focal=0.00348, loss_dice=0.474, distill_loss=0.164, acc=0.985, av_BS_IoU=0.940, av_BS_pa=0.993, loss_iou=0.122, train_per_mask_iou=0.757]Epoch 0:   8%|▊         | 139/1818 [01:57<23:44,  1.18it/s, loss=0.594, v_num=77, loss_focal=0.0139, loss_dice=0.283, distill_loss=0.131, acc=0.977, av_BS_IoU=0.719, av_BS_pa=0.975, loss_iou=3.82e-5, train_per_mask_iou=0.757]Epoch 0:   8%|▊         | 140/1818 [01:58<23:40,  1.18it/s, loss=0.594, v_num=77, loss_focal=0.0139, loss_dice=0.283, distill_loss=0.131, acc=0.977, av_BS_IoU=0.719, av_BS_pa=0.975, loss_iou=3.82e-5, train_per_mask_iou=0.757]Epoch 0:   8%|▊         | 140/1818 [01:58<23:40,  1.18it/s, loss=0.657, v_num=77, loss_focal=0.00329, loss_dice=0.295, distill_loss=0.151, acc=0.988, av_BS_IoU=0.931, av_BS_pa=0.990, loss_iou=0.141, train_per_mask_iou=0.758] Epoch 0:   8%|▊         | 141/1818 [01:59<23:43,  1.18it/s, loss=0.657, v_num=77, loss_focal=0.00329, loss_dice=0.295, distill_loss=0.151, acc=0.988, av_BS_IoU=0.931, av_BS_pa=0.990, loss_iou=0.141, train_per_mask_iou=0.758]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   8%|▊         | 141/1818 [01:59<23:43,  1.18it/s, loss=0.829, v_num=77, loss_focal=0.00688, loss_dice=0.503, distill_loss=0.137, acc=0.965, av_BS_IoU=0.798, av_BS_pa=0.981, loss_iou=0.0433, train_per_mask_iou=0.757]Epoch 0:   8%|▊         | 142/1818 [02:00<23:42,  1.18it/s, loss=0.829, v_num=77, loss_focal=0.00688, loss_dice=0.503, distill_loss=0.137, acc=0.965, av_BS_IoU=0.798, av_BS_pa=0.981, loss_iou=0.0433, train_per_mask_iou=0.757]Epoch 0:   8%|▊         | 142/1818 [02:00<23:42,  1.18it/s, loss=0.946, v_num=77, loss_focal=0.00633, loss_dice=0.471, distill_loss=0.175, acc=0.246, av_BS_IoU=0.722, av_BS_pa=0.967, loss_iou=0.102, train_per_mask_iou=0.758] Epoch 0:   8%|▊         | 143/1818 [02:01<23:38,  1.18it/s, loss=0.946, v_num=77, loss_focal=0.00633, loss_dice=0.471, distill_loss=0.175, acc=0.246, av_BS_IoU=0.722, av_BS_pa=0.967, loss_iou=0.102, train_per_mask_iou=0.758]Epoch 0:   8%|▊         | 143/1818 [02:01<23:38,  1.18it/s, loss=0.256, v_num=77, loss_focal=0.00123, loss_dice=0.0596, distill_loss=0.145, acc=0.499, av_BS_IoU=0.918, av_BS_pa=0.997, loss_iou=0.00591, train_per_mask_iou=0.760]Epoch 0:   8%|▊         | 144/1818 [02:01<23:34,  1.18it/s, loss=0.256, v_num=77, loss_focal=0.00123, loss_dice=0.0596, distill_loss=0.145, acc=0.499, av_BS_IoU=0.918, av_BS_pa=0.997, loss_iou=0.00591, train_per_mask_iou=0.760]Epoch 0:   8%|▊         | 144/1818 [02:01<23:34,  1.18it/s, loss=0.486, v_num=77, loss_focal=0.000547, loss_dice=0.170, distill_loss=0.185, acc=0.999, av_BS_IoU=0.723, av_BS_pa=0.999, loss_iou=0.0233, train_per_mask_iou=0.760] Epoch 0:   8%|▊         | 145/1818 [02:02<23:34,  1.18it/s, loss=0.486, v_num=77, loss_focal=0.000547, loss_dice=0.170, distill_loss=0.185, acc=0.999, av_BS_IoU=0.723, av_BS_pa=0.999, loss_iou=0.0233, train_per_mask_iou=0.760]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   8%|▊         | 145/1818 [02:02<23:34,  1.18it/s, loss=1.850, v_num=77, loss_focal=0.0748, loss_dice=0.497, distill_loss=0.189, acc=0.951, av_BS_IoU=0.324, av_BS_pa=0.952, loss_iou=0.126, train_per_mask_iou=0.758]   Epoch 0:   8%|▊         | 146/1818 [02:03<23:30,  1.19it/s, loss=1.850, v_num=77, loss_focal=0.0748, loss_dice=0.497, distill_loss=0.189, acc=0.951, av_BS_IoU=0.324, av_BS_pa=0.952, loss_iou=0.126, train_per_mask_iou=0.758]Epoch 0:   8%|▊         | 146/1818 [02:03<23:30,  1.19it/s, loss=0.286, v_num=77, loss_focal=0.00324, loss_dice=0.056, distill_loss=0.167, acc=0.992, av_BS_IoU=0.913, av_BS_pa=0.991, loss_iou=0.000333, train_per_mask_iou=0.758]Epoch 0:   8%|▊         | 147/1818 [02:03<23:26,  1.19it/s, loss=0.286, v_num=77, loss_focal=0.00324, loss_dice=0.056, distill_loss=0.167, acc=0.992, av_BS_IoU=0.913, av_BS_pa=0.991, loss_iou=0.000333, train_per_mask_iou=0.758]Epoch 0:   8%|▊         | 147/1818 [02:03<23:26,  1.19it/s, loss=0.411, v_num=77, loss_focal=0.00234, loss_dice=0.167, distill_loss=0.132, acc=0.996, av_BS_IoU=0.889, av_BS_pa=0.996, loss_iou=0.0503, train_per_mask_iou=0.759]  Epoch 0:   8%|▊         | 148/1818 [02:04<23:22,  1.19it/s, loss=0.411, v_num=77, loss_focal=0.00234, loss_dice=0.167, distill_loss=0.132, acc=0.996, av_BS_IoU=0.889, av_BS_pa=0.996, loss_iou=0.0503, train_per_mask_iou=0.759]Epoch 0:   8%|▊         | 148/1818 [02:04<23:22,  1.19it/s, loss=0.731, v_num=77, loss_focal=0.00991, loss_dice=0.345, distill_loss=0.169, acc=0.983, av_BS_IoU=0.637, av_BS_pa=0.980, loss_iou=0.001, train_per_mask_iou=0.759] Epoch 0:   8%|▊         | 149/1818 [02:04<23:19,  1.19it/s, loss=0.731, v_num=77, loss_focal=0.00991, loss_dice=0.345, distill_loss=0.169, acc=0.983, av_BS_IoU=0.637, av_BS_pa=0.980, loss_iou=0.001, train_per_mask_iou=0.759]Epoch 0:   8%|▊         | 149/1818 [02:04<23:19,  1.19it/s, loss=1.880, v_num=77, loss_focal=0.0257, loss_dice=0.656, distill_loss=0.200, acc=0.993, av_BS_IoU=0.206, av_BS_pa=0.993, loss_iou=0.106, train_per_mask_iou=0.756] Epoch 0:   8%|▊         | 150/1818 [02:05<23:15,  1.20it/s, loss=1.880, v_num=77, loss_focal=0.0257, loss_dice=0.656, distill_loss=0.200, acc=0.993, av_BS_IoU=0.206, av_BS_pa=0.993, loss_iou=0.106, train_per_mask_iou=0.756]Epoch 0:   8%|▊         | 150/1818 [02:05<23:15,  1.20it/s, loss=0.726, v_num=77, loss_focal=0.0127, loss_dice=0.366, distill_loss=0.144, acc=0.972, av_BS_IoU=0.669, av_BS_pa=0.958, loss_iou=0.0039, train_per_mask_iou=0.756]Epoch 0:   8%|▊         | 151/1818 [02:06<23:12,  1.20it/s, loss=0.726, v_num=77, loss_focal=0.0127, loss_dice=0.366, distill_loss=0.144, acc=0.972, av_BS_IoU=0.669, av_BS_pa=0.958, loss_iou=0.0039, train_per_mask_iou=0.756]Epoch 0:   8%|▊         | 151/1818 [02:06<23:12,  1.20it/s, loss=5.120, v_num=77, loss_focal=0.281, loss_dice=0.830, distill_loss=0.190, acc=0.783, av_BS_IoU=0.0272, av_BS_pa=0.784, loss_iou=0.166, train_per_mask_iou=0.752] Epoch 0:   8%|▊         | 152/1818 [02:07<23:13,  1.20it/s, loss=5.120, v_num=77, loss_focal=0.281, loss_dice=0.830, distill_loss=0.190, acc=0.783, av_BS_IoU=0.0272, av_BS_pa=0.784, loss_iou=0.166, train_per_mask_iou=0.752]Epoch 0:   8%|▊         | 152/1818 [02:07<23:13,  1.20it/s, loss=0.629, v_num=77, loss_focal=0.033, loss_dice=0.165, distill_loss=0.186, acc=0.853, av_BS_IoU=0.772, av_BS_pa=0.894, loss_iou=0.0035, train_per_mask_iou=0.752]Epoch 0:   8%|▊         | 153/1818 [02:08<23:14,  1.19it/s, loss=0.629, v_num=77, loss_focal=0.033, loss_dice=0.165, distill_loss=0.186, acc=0.853, av_BS_IoU=0.772, av_BS_pa=0.894, loss_iou=0.0035, train_per_mask_iou=0.752]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   8%|▊         | 153/1818 [02:08<23:14,  1.19it/s, loss=0.542, v_num=77, loss_focal=0.0014, loss_dice=0.281, distill_loss=0.160, acc=0.996, av_BS_IoU=0.803, av_BS_pa=0.996, loss_iou=0.00888, train_per_mask_iou=0.752]Epoch 0:   8%|▊         | 154/1818 [02:09<23:14,  1.19it/s, loss=0.542, v_num=77, loss_focal=0.0014, loss_dice=0.281, distill_loss=0.160, acc=0.996, av_BS_IoU=0.803, av_BS_pa=0.996, loss_iou=0.00888, train_per_mask_iou=0.752]Epoch 0:   8%|▊         | 154/1818 [02:09<23:14,  1.19it/s, loss=1.890, v_num=77, loss_focal=0.0538, loss_dice=0.584, distill_loss=0.157, acc=0.973, av_BS_IoU=0.276, av_BS_pa=0.973, loss_iou=0.161, train_per_mask_iou=0.750]  Epoch 0:   9%|▊         | 155/1818 [02:09<23:11,  1.20it/s, loss=1.890, v_num=77, loss_focal=0.0538, loss_dice=0.584, distill_loss=0.157, acc=0.973, av_BS_IoU=0.276, av_BS_pa=0.973, loss_iou=0.161, train_per_mask_iou=0.750]Epoch 0:   9%|▊         | 155/1818 [02:09<23:11,  1.20it/s, loss=0.290, v_num=77, loss_focal=0.00117, loss_dice=0.0525, distill_loss=0.186, acc=0.998, av_BS_IoU=0.954, av_BS_pa=0.997, loss_iou=0.00253, train_per_mask_iou=0.751]Epoch 0:   9%|▊         | 156/1818 [02:10<23:08,  1.20it/s, loss=0.290, v_num=77, loss_focal=0.00117, loss_dice=0.0525, distill_loss=0.186, acc=0.998, av_BS_IoU=0.954, av_BS_pa=0.997, loss_iou=0.00253, train_per_mask_iou=0.751]Epoch 0:   9%|▊         | 156/1818 [02:10<23:08,  1.20it/s, loss=0.955, v_num=77, loss_focal=0.00042, loss_dice=0.636, distill_loss=0.151, acc=0.999, av_BS_IoU=0.790, av_BS_pa=0.998, loss_iou=0.0357, train_per_mask_iou=0.751]  Epoch 0:   9%|▊         | 157/1818 [02:11<23:10,  1.19it/s, loss=0.955, v_num=77, loss_focal=0.00042, loss_dice=0.636, distill_loss=0.151, acc=0.999, av_BS_IoU=0.790, av_BS_pa=0.998, loss_iou=0.0357, train_per_mask_iou=0.751]Epoch 0:   9%|▊         | 157/1818 [02:11<23:10,  1.19it/s, loss=1.930, v_num=77, loss_focal=0.042, loss_dice=0.608, distill_loss=0.245, acc=0.430, av_BS_IoU=0.311, av_BS_pa=0.772, loss_iou=0.153, train_per_mask_iou=0.747]   Epoch 0:   9%|▊         | 158/1818 [02:12<23:07,  1.20it/s, loss=1.930, v_num=77, loss_focal=0.042, loss_dice=0.608, distill_loss=0.245, acc=0.430, av_BS_IoU=0.311, av_BS_pa=0.772, loss_iou=0.153, train_per_mask_iou=0.747]Epoch 0:   9%|▊         | 158/1818 [02:12<23:07,  1.20it/s, loss=0.741, v_num=77, loss_focal=0.0166, loss_dice=0.329, distill_loss=0.140, acc=0.894, av_BS_IoU=0.572, av_BS_pa=0.914, loss_iou=0.00254, train_per_mask_iou=0.746]Epoch 0:   9%|▊         | 159/1818 [02:12<23:04,  1.20it/s, loss=0.741, v_num=77, loss_focal=0.0166, loss_dice=0.329, distill_loss=0.140, acc=0.894, av_BS_IoU=0.572, av_BS_pa=0.914, loss_iou=0.00254, train_per_mask_iou=0.746]Epoch 0:   9%|▊         | 159/1818 [02:12<23:04,  1.20it/s, loss=0.465, v_num=77, loss_focal=0.0099, loss_dice=0.193, distill_loss=0.150, acc=0.977, av_BS_IoU=0.822, av_BS_pa=0.981, loss_iou=1.51e-5, train_per_mask_iou=0.746]Epoch 0:   9%|▉         | 160/1818 [02:13<23:00,  1.20it/s, loss=0.465, v_num=77, loss_focal=0.0099, loss_dice=0.193, distill_loss=0.150, acc=0.977, av_BS_IoU=0.822, av_BS_pa=0.981, loss_iou=1.51e-5, train_per_mask_iou=0.746]Epoch 0:   9%|▉         | 160/1818 [02:13<23:00,  1.20it/s, loss=0.286, v_num=77, loss_focal=0.00183, loss_dice=0.067, distill_loss=0.163, acc=0.997, av_BS_IoU=0.915, av_BS_pa=0.997, loss_iou=0.0025, train_per_mask_iou=0.747]Epoch 0:   9%|▉         | 161/1818 [02:13<22:58,  1.20it/s, loss=0.286, v_num=77, loss_focal=0.00183, loss_dice=0.067, distill_loss=0.163, acc=0.997, av_BS_IoU=0.915, av_BS_pa=0.997, loss_iou=0.0025, train_per_mask_iou=0.747]Epoch 0:   9%|▉         | 161/1818 [02:13<22:58,  1.20it/s, loss=0.296, v_num=77, loss_focal=0.00258, loss_dice=0.0914, distill_loss=0.142, acc=0.994, av_BS_IoU=0.911, av_BS_pa=0.992, loss_iou=0.00826, train_per_mask_iou=0.748]Epoch 0:   9%|▉         | 162/1818 [02:14<22:57,  1.20it/s, loss=0.296, v_num=77, loss_focal=0.00258, loss_dice=0.0914, distill_loss=0.142, acc=0.994, av_BS_IoU=0.911, av_BS_pa=0.992, loss_iou=0.00826, train_per_mask_iou=0.748]Epoch 0:   9%|▉         | 162/1818 [02:14<22:57,  1.20it/s, loss=0.392, v_num=77, loss_focal=0.00147, loss_dice=0.166, distill_loss=0.160, acc=0.996, av_BS_IoU=0.944, av_BS_pa=0.993, loss_iou=0.015, train_per_mask_iou=0.749]   Epoch 0:   9%|▉         | 163/1818 [02:15<22:53,  1.20it/s, loss=0.392, v_num=77, loss_focal=0.00147, loss_dice=0.166, distill_loss=0.160, acc=0.996, av_BS_IoU=0.944, av_BS_pa=0.993, loss_iou=0.015, train_per_mask_iou=0.749]Epoch 0:   9%|▉         | 163/1818 [02:15<22:53,  1.20it/s, loss=0.348, v_num=77, loss_focal=0.00405, loss_dice=0.133, distill_loss=0.127, acc=0.988, av_BS_IoU=0.877, av_BS_pa=0.988, loss_iou=0.0218, train_per_mask_iou=0.749]Epoch 0:   9%|▉         | 164/1818 [02:16<22:54,  1.20it/s, loss=0.348, v_num=77, loss_focal=0.00405, loss_dice=0.133, distill_loss=0.127, acc=0.988, av_BS_IoU=0.877, av_BS_pa=0.988, loss_iou=0.0218, train_per_mask_iou=0.749]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:   9%|▉         | 164/1818 [02:16<22:54,  1.20it/s, loss=0.522, v_num=77, loss_focal=0.00902, loss_dice=0.233, distill_loss=0.157, acc=0.958, av_BS_IoU=0.874, av_BS_pa=0.982, loss_iou=0.0231, train_per_mask_iou=0.749]Epoch 0:   9%|▉         | 165/1818 [02:16<22:50,  1.21it/s, loss=0.522, v_num=77, loss_focal=0.00902, loss_dice=0.233, distill_loss=0.157, acc=0.958, av_BS_IoU=0.874, av_BS_pa=0.982, loss_iou=0.0231, train_per_mask_iou=0.749]Epoch 0:   9%|▉         | 165/1818 [02:16<22:50,  1.21it/s, loss=0.360, v_num=77, loss_focal=0.000616, loss_dice=0.102, distill_loss=0.169, acc=0.999, av_BS_IoU=0.833, av_BS_pa=0.999, loss_iou=0.0214, train_per_mask_iou=0.749]Epoch 0:   9%|▉         | 166/1818 [02:17<22:53,  1.20it/s, loss=0.360, v_num=77, loss_focal=0.000616, loss_dice=0.102, distill_loss=0.169, acc=0.999, av_BS_IoU=0.833, av_BS_pa=0.999, loss_iou=0.0214, train_per_mask_iou=0.749]Epoch 0:   9%|▉         | 166/1818 [02:17<22:53,  1.20it/s, loss=0.421, v_num=77, loss_focal=0.0011, loss_dice=0.126, distill_loss=0.152, acc=0.998, av_BS_IoU=0.840, av_BS_pa=0.998, loss_iou=0.0728, train_per_mask_iou=0.750]  Epoch 0:   9%|▉         | 167/1818 [02:18<22:49,  1.21it/s, loss=0.421, v_num=77, loss_focal=0.0011, loss_dice=0.126, distill_loss=0.152, acc=0.998, av_BS_IoU=0.840, av_BS_pa=0.998, loss_iou=0.0728, train_per_mask_iou=0.750]Epoch 0:   9%|▉         | 167/1818 [02:18<22:49,  1.21it/s, loss=0.587, v_num=77, loss_focal=0.00623, loss_dice=0.258, distill_loss=0.162, acc=0.981, av_BS_IoU=0.840, av_BS_pa=0.977, loss_iou=0.056, train_per_mask_iou=0.750]Epoch 0:   9%|▉         | 168/1818 [02:19<22:46,  1.21it/s, loss=0.587, v_num=77, loss_focal=0.00623, loss_dice=0.258, distill_loss=0.162, acc=0.981, av_BS_IoU=0.840, av_BS_pa=0.977, loss_iou=0.056, train_per_mask_iou=0.750]Epoch 0:   9%|▉         | 168/1818 [02:19<22:46,  1.21it/s, loss=0.274, v_num=77, loss_focal=0.00291, loss_dice=0.0446, distill_loss=0.173, acc=0.995, av_BS_IoU=0.971, av_BS_pa=0.993, loss_iou=0.00332, train_per_mask_iou=0.751]Epoch 0:   9%|▉         | 169/1818 [02:19<22:43,  1.21it/s, loss=0.274, v_num=77, loss_focal=0.00291, loss_dice=0.0446, distill_loss=0.173, acc=0.995, av_BS_IoU=0.971, av_BS_pa=0.993, loss_iou=0.00332, train_per_mask_iou=0.751]Epoch 0:   9%|▉         | 169/1818 [02:19<22:43,  1.21it/s, loss=1.010, v_num=77, loss_focal=0.0218, loss_dice=0.481, distill_loss=0.140, acc=0.744, av_BS_IoU=0.537, av_BS_pa=0.866, loss_iou=0.0222, train_per_mask_iou=0.749]   Epoch 0:   9%|▉         | 170/1818 [02:20<22:39,  1.21it/s, loss=1.010, v_num=77, loss_focal=0.0218, loss_dice=0.481, distill_loss=0.140, acc=0.744, av_BS_IoU=0.537, av_BS_pa=0.866, loss_iou=0.0222, train_per_mask_iou=0.749]Epoch 0:   9%|▉         | 170/1818 [02:20<22:39,  1.21it/s, loss=1.590, v_num=77, loss_focal=0.0787, loss_dice=0.400, distill_loss=0.150, acc=0.934, av_BS_IoU=0.394, av_BS_pa=0.935, loss_iou=0.132, train_per_mask_iou=0.747] Epoch 0:   9%|▉         | 171/1818 [02:20<22:36,  1.21it/s, loss=1.590, v_num=77, loss_focal=0.0787, loss_dice=0.400, distill_loss=0.150, acc=0.934, av_BS_IoU=0.394, av_BS_pa=0.935, loss_iou=0.132, train_per_mask_iou=0.747]Epoch 0:   9%|▉         | 171/1818 [02:20<22:36,  1.21it/s, loss=0.253, v_num=77, loss_focal=0.00176, loss_dice=0.0544, distill_loss=0.140, acc=0.993, av_BS_IoU=0.946, av_BS_pa=0.992, loss_iou=0.0158, train_per_mask_iou=0.748]Epoch 0:   9%|▉         | 172/1818 [02:21<22:33,  1.22it/s, loss=0.253, v_num=77, loss_focal=0.00176, loss_dice=0.0544, distill_loss=0.140, acc=0.993, av_BS_IoU=0.946, av_BS_pa=0.992, loss_iou=0.0158, train_per_mask_iou=0.748]Epoch 0:   9%|▉         | 172/1818 [02:21<22:33,  1.22it/s, loss=0.472, v_num=77, loss_focal=0.000575, loss_dice=0.214, distill_loss=0.162, acc=0.999, av_BS_IoU=0.850, av_BS_pa=0.999, loss_iou=0.0251, train_per_mask_iou=0.748]Epoch 0:  10%|▉         | 173/1818 [02:22<22:36,  1.21it/s, loss=0.472, v_num=77, loss_focal=0.000575, loss_dice=0.214, distill_loss=0.162, acc=0.999, av_BS_IoU=0.850, av_BS_pa=0.999, loss_iou=0.0251, train_per_mask_iou=0.748]Epoch 0:  10%|▉         | 173/1818 [02:22<22:36,  1.21it/s, loss=0.356, v_num=77, loss_focal=0.000795, loss_dice=0.132, distill_loss=0.153, acc=0.999, av_BS_IoU=0.820, av_BS_pa=0.999, loss_iou=0.00323, train_per_mask_iou=0.749]Epoch 0:  10%|▉         | 174/1818 [02:23<22:33,  1.21it/s, loss=0.356, v_num=77, loss_focal=0.000795, loss_dice=0.132, distill_loss=0.153, acc=0.999, av_BS_IoU=0.820, av_BS_pa=0.999, loss_iou=0.00323, train_per_mask_iou=0.749]Epoch 0:  10%|▉         | 174/1818 [02:23<22:33,  1.21it/s, loss=0.254, v_num=77, loss_focal=0.00202, loss_dice=0.0575, distill_loss=0.142, acc=0.996, av_BS_IoU=0.933, av_BS_pa=0.996, loss_iou=0.00705, train_per_mask_iou=0.750]Epoch 0:  10%|▉         | 175/1818 [02:23<22:30,  1.22it/s, loss=0.254, v_num=77, loss_focal=0.00202, loss_dice=0.0575, distill_loss=0.142, acc=0.996, av_BS_IoU=0.933, av_BS_pa=0.996, loss_iou=0.00705, train_per_mask_iou=0.750]Epoch 0:  10%|▉         | 175/1818 [02:23<22:30,  1.22it/s, loss=0.329, v_num=77, loss_focal=0.00147, loss_dice=0.0949, distill_loss=0.176, acc=0.996, av_BS_IoU=0.939, av_BS_pa=0.996, loss_iou=0.00485, train_per_mask_iou=0.750]Epoch 0:  10%|▉         | 176/1818 [02:28<23:08,  1.18it/s, loss=0.329, v_num=77, loss_focal=0.00147, loss_dice=0.0949, distill_loss=0.176, acc=0.996, av_BS_IoU=0.939, av_BS_pa=0.996, loss_iou=0.00485, train_per_mask_iou=0.750]Epoch 0:  10%|▉         | 176/1818 [02:28<23:08,  1.18it/s, loss=0.260, v_num=77, loss_focal=0.00111, loss_dice=0.0803, distill_loss=0.134, acc=0.499, av_BS_IoU=0.907, av_BS_pa=0.996, loss_iou=0.00153, train_per_mask_iou=0.752]Epoch 0:  10%|▉         | 177/1818 [02:29<23:04,  1.18it/s, loss=0.260, v_num=77, loss_focal=0.00111, loss_dice=0.0803, distill_loss=0.134, acc=0.499, av_BS_IoU=0.907, av_BS_pa=0.996, loss_iou=0.00153, train_per_mask_iou=0.752]Epoch 0:  10%|▉         | 177/1818 [02:29<23:05,  1.18it/s, loss=0.734, v_num=77, loss_focal=0.0327, loss_dice=0.246, distill_loss=0.147, acc=0.969, av_BS_IoU=0.643, av_BS_pa=0.966, loss_iou=0.0175, train_per_mask_iou=0.751]   Epoch 0:  10%|▉         | 178/1818 [02:29<23:01,  1.19it/s, loss=0.734, v_num=77, loss_focal=0.0327, loss_dice=0.246, distill_loss=0.147, acc=0.969, av_BS_IoU=0.643, av_BS_pa=0.966, loss_iou=0.0175, train_per_mask_iou=0.751]Epoch 0:  10%|▉         | 178/1818 [02:29<23:01,  1.19it/s, loss=0.379, v_num=77, loss_focal=0.00418, loss_dice=0.130, distill_loss=0.170, acc=0.984, av_BS_IoU=0.950, av_BS_pa=0.980, loss_iou=0.0142, train_per_mask_iou=0.752]Epoch 0:  10%|▉         | 179/1818 [02:30<22:58,  1.19it/s, loss=0.379, v_num=77, loss_focal=0.00418, loss_dice=0.130, distill_loss=0.170, acc=0.984, av_BS_IoU=0.950, av_BS_pa=0.980, loss_iou=0.0142, train_per_mask_iou=0.752]Epoch 0:  10%|▉         | 179/1818 [02:30<22:58,  1.19it/s, loss=0.724, v_num=77, loss_focal=0.00958, loss_dice=0.337, distill_loss=0.188, acc=0.954, av_BS_IoU=0.843, av_BS_pa=0.957, loss_iou=0.056, train_per_mask_iou=0.753] Epoch 0:  10%|▉         | 180/1818 [02:31<22:55,  1.19it/s, loss=0.724, v_num=77, loss_focal=0.00958, loss_dice=0.337, distill_loss=0.188, acc=0.954, av_BS_IoU=0.843, av_BS_pa=0.957, loss_iou=0.056, train_per_mask_iou=0.753]Epoch 0:  10%|▉         | 180/1818 [02:31<22:55,  1.19it/s, loss=0.594, v_num=77, loss_focal=0.00854, loss_dice=0.227, distill_loss=0.186, acc=0.961, av_BS_IoU=0.924, av_BS_pa=0.963, loss_iou=0.0771, train_per_mask_iou=0.753]Epoch 0:  10%|▉         | 181/1818 [02:31<22:52,  1.19it/s, loss=0.594, v_num=77, loss_focal=0.00854, loss_dice=0.227, distill_loss=0.186, acc=0.961, av_BS_IoU=0.924, av_BS_pa=0.963, loss_iou=0.0771, train_per_mask_iou=0.753]Epoch 0:  10%|▉         | 181/1818 [02:31<22:52,  1.19it/s, loss=1.660, v_num=77, loss_focal=0.00422, loss_dice=0.862, distill_loss=0.154, acc=0.984, av_BS_IoU=0.301, av_BS_pa=0.986, loss_iou=0.0118, train_per_mask_iou=0.751]Epoch 0:  10%|█         | 182/1818 [02:32<22:53,  1.19it/s, loss=1.660, v_num=77, loss_focal=0.00422, loss_dice=0.862, distill_loss=0.154, acc=0.984, av_BS_IoU=0.301, av_BS_pa=0.986, loss_iou=0.0118, train_per_mask_iou=0.751]Epoch 0:  10%|█         | 182/1818 [02:32<22:53,  1.19it/s, loss=0.360, v_num=77, loss_focal=0.00883, loss_dice=0.123, distill_loss=0.129, acc=0.972, av_BS_IoU=0.940, av_BS_pa=0.968, loss_iou=0.0263, train_per_mask_iou=0.752]Epoch 0:  10%|█         | 183/1818 [02:33<22:54,  1.19it/s, loss=0.360, v_num=77, loss_focal=0.00883, loss_dice=0.123, distill_loss=0.129, acc=0.972, av_BS_IoU=0.940, av_BS_pa=0.968, loss_iou=0.0263, train_per_mask_iou=0.752]Epoch 0:  10%|█         | 183/1818 [02:33<22:54,  1.19it/s, loss=0.459, v_num=77, loss_focal=0.00359, loss_dice=0.109, distill_loss=0.178, acc=0.997, av_BS_IoU=0.858, av_BS_pa=0.997, loss_iou=0.0863, train_per_mask_iou=0.752]Epoch 0:  10%|█         | 184/1818 [02:34<22:51,  1.19it/s, loss=0.459, v_num=77, loss_focal=0.00359, loss_dice=0.109, distill_loss=0.178, acc=0.997, av_BS_IoU=0.858, av_BS_pa=0.997, loss_iou=0.0863, train_per_mask_iou=0.752]Epoch 0:  10%|█         | 184/1818 [02:34<22:51,  1.19it/s, loss=0.456, v_num=77, loss_focal=0.00724, loss_dice=0.165, distill_loss=0.168, acc=0.986, av_BS_IoU=0.776, av_BS_pa=0.983, loss_iou=0.00148, train_per_mask_iou=0.752]Epoch 0:  10%|█         | 185/1818 [02:35<22:48,  1.19it/s, loss=0.456, v_num=77, loss_focal=0.00724, loss_dice=0.165, distill_loss=0.168, acc=0.986, av_BS_IoU=0.776, av_BS_pa=0.983, loss_iou=0.00148, train_per_mask_iou=0.752]Epoch 0:  10%|█         | 185/1818 [02:35<22:48,  1.19it/s, loss=0.301, v_num=77, loss_focal=0.00728, loss_dice=0.0513, distill_loss=0.168, acc=0.985, av_BS_IoU=0.918, av_BS_pa=0.984, loss_iou=1.01e-5, train_per_mask_iou=0.753]Epoch 0:  10%|█         | 186/1818 [02:36<22:51,  1.19it/s, loss=0.301, v_num=77, loss_focal=0.00728, loss_dice=0.0513, distill_loss=0.168, acc=0.985, av_BS_IoU=0.918, av_BS_pa=0.984, loss_iou=1.01e-5, train_per_mask_iou=0.753]Epoch 0:  10%|█         | 186/1818 [02:36<22:51,  1.19it/s, loss=0.413, v_num=77, loss_focal=0.00075, loss_dice=0.147, distill_loss=0.151, acc=0.999, av_BS_IoU=0.754, av_BS_pa=0.999, loss_iou=0.0307, train_per_mask_iou=0.753]  Epoch 0:  10%|█         | 187/1818 [02:37<22:52,  1.19it/s, loss=0.413, v_num=77, loss_focal=0.00075, loss_dice=0.147, distill_loss=0.151, acc=0.999, av_BS_IoU=0.754, av_BS_pa=0.999, loss_iou=0.0307, train_per_mask_iou=0.753]Epoch 0:  10%|█         | 187/1818 [02:37<22:52,  1.19it/s, loss=0.414, v_num=77, loss_focal=0.00191, loss_dice=0.158, distill_loss=0.181, acc=0.994, av_BS_IoU=0.902, av_BS_pa=0.993, loss_iou=0.00909, train_per_mask_iou=0.754]Epoch 0:  10%|█         | 188/1818 [02:37<22:48,  1.19it/s, loss=0.414, v_num=77, loss_focal=0.00191, loss_dice=0.158, distill_loss=0.181, acc=0.994, av_BS_IoU=0.902, av_BS_pa=0.993, loss_iou=0.00909, train_per_mask_iou=0.754]Epoch 0:  10%|█         | 188/1818 [02:37<22:48,  1.19it/s, loss=0.261, v_num=77, loss_focal=0.000837, loss_dice=0.0565, distill_loss=0.159, acc=0.997, av_BS_IoU=0.976, av_BS_pa=0.995, loss_iou=0.00542, train_per_mask_iou=0.755]Epoch 0:  10%|█         | 189/1818 [02:38<22:45,  1.19it/s, loss=0.261, v_num=77, loss_focal=0.000837, loss_dice=0.0565, distill_loss=0.159, acc=0.997, av_BS_IoU=0.976, av_BS_pa=0.995, loss_iou=0.00542, train_per_mask_iou=0.755]Epoch 0:  10%|█         | 189/1818 [02:38<22:45,  1.19it/s, loss=0.299, v_num=77, loss_focal=0.00171, loss_dice=0.0673, distill_loss=0.177, acc=0.995, av_BS_IoU=0.954, av_BS_pa=0.992, loss_iou=0.00335, train_per_mask_iou=0.756] Epoch 0:  10%|█         | 190/1818 [02:40<22:51,  1.19it/s, loss=0.299, v_num=77, loss_focal=0.00171, loss_dice=0.0673, distill_loss=0.177, acc=0.995, av_BS_IoU=0.954, av_BS_pa=0.992, loss_iou=0.00335, train_per_mask_iou=0.756]Epoch 0:  10%|█         | 190/1818 [02:40<22:51,  1.19it/s, loss=0.656, v_num=77, loss_focal=0.00127, loss_dice=0.210, distill_loss=0.136, acc=0.997, av_BS_IoU=0.830, av_BS_pa=0.997, loss_iou=0.222, train_per_mask_iou=0.756]   Epoch 0:  11%|█         | 191/1818 [02:41<22:52,  1.19it/s, loss=0.656, v_num=77, loss_focal=0.00127, loss_dice=0.210, distill_loss=0.136, acc=0.997, av_BS_IoU=0.830, av_BS_pa=0.997, loss_iou=0.222, train_per_mask_iou=0.756]Epoch 0:  11%|█         | 191/1818 [02:41<22:52,  1.19it/s, loss=0.246, v_num=77, loss_focal=0.00135, loss_dice=0.0604, distill_loss=0.142, acc=0.996, av_BS_IoU=0.939, av_BS_pa=0.994, loss_iou=0.00171, train_per_mask_iou=0.757]Epoch 0:  11%|█         | 192/1818 [02:42<22:52,  1.18it/s, loss=0.246, v_num=77, loss_focal=0.00135, loss_dice=0.0604, distill_loss=0.142, acc=0.996, av_BS_IoU=0.939, av_BS_pa=0.994, loss_iou=0.00171, train_per_mask_iou=0.757]Epoch 0:  11%|█         | 192/1818 [02:42<22:52,  1.18it/s, loss=0.393, v_num=77, loss_focal=0.000631, loss_dice=0.126, distill_loss=0.140, acc=0.997, av_BS_IoU=0.963, av_BS_pa=0.997, loss_iou=0.0881, train_per_mask_iou=0.758] Epoch 0:  11%|█         | 193/1818 [02:43<22:53,  1.18it/s, loss=0.393, v_num=77, loss_focal=0.000631, loss_dice=0.126, distill_loss=0.140, acc=0.997, av_BS_IoU=0.963, av_BS_pa=0.997, loss_iou=0.0881, train_per_mask_iou=0.758]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:  11%|█         | 193/1818 [02:43<22:53,  1.18it/s, loss=0.452, v_num=77, loss_focal=0.00321, loss_dice=0.187, distill_loss=0.159, acc=0.992, av_BS_IoU=0.903, av_BS_pa=0.989, loss_iou=0.0361, train_per_mask_iou=0.758] Epoch 0:  11%|█         | 194/1818 [02:44<22:53,  1.18it/s, loss=0.452, v_num=77, loss_focal=0.00321, loss_dice=0.187, distill_loss=0.159, acc=0.992, av_BS_IoU=0.903, av_BS_pa=0.989, loss_iou=0.0361, train_per_mask_iou=0.758]Epoch 0:  11%|█         | 194/1818 [02:44<22:53,  1.18it/s, loss=0.456, v_num=77, loss_focal=0.00369, loss_dice=0.168, distill_loss=0.175, acc=0.997, av_BS_IoU=0.758, av_BS_pa=0.997, loss_iou=0.00417, train_per_mask_iou=0.758]Epoch 0:  11%|█         | 195/1818 [02:44<22:49,  1.18it/s, loss=0.456, v_num=77, loss_focal=0.00369, loss_dice=0.168, distill_loss=0.175, acc=0.997, av_BS_IoU=0.758, av_BS_pa=0.997, loss_iou=0.00417, train_per_mask_iou=0.758]Epoch 0:  11%|█         | 195/1818 [02:44<22:49,  1.18it/s, loss=0.493, v_num=77, loss_focal=0.00241, loss_dice=0.247, distill_loss=0.147, acc=0.994, av_BS_IoU=0.855, av_BS_pa=0.995, loss_iou=0.0215, train_per_mask_iou=0.759] Epoch 0:  11%|█         | 196/1818 [02:45<22:46,  1.19it/s, loss=0.493, v_num=77, loss_focal=0.00241, loss_dice=0.247, distill_loss=0.147, acc=0.994, av_BS_IoU=0.855, av_BS_pa=0.995, loss_iou=0.0215, train_per_mask_iou=0.759]Epoch 0:  11%|█         | 196/1818 [02:45<22:46,  1.19it/s, loss=0.390, v_num=77, loss_focal=0.00272, loss_dice=0.106, distill_loss=0.201, acc=0.993, av_BS_IoU=0.889, av_BS_pa=0.991, loss_iou=0.00668, train_per_mask_iou=0.759]Epoch 0:  11%|█         | 197/1818 [02:46<22:47,  1.19it/s, loss=0.390, v_num=77, loss_focal=0.00272, loss_dice=0.106, distill_loss=0.201, acc=0.993, av_BS_IoU=0.889, av_BS_pa=0.991, loss_iou=0.00668, train_per_mask_iou=0.759]Epoch 0:  11%|█         | 197/1818 [02:46<22:47,  1.19it/s, loss=0.296, v_num=77, loss_focal=0.00145, loss_dice=0.0945, distill_loss=0.147, acc=0.995, av_BS_IoU=0.928, av_BS_pa=0.995, loss_iou=0.00738, train_per_mask_iou=0.760]Epoch 0:  11%|█         | 198/1818 [02:46<22:44,  1.19it/s, loss=0.296, v_num=77, loss_focal=0.00145, loss_dice=0.0945, distill_loss=0.147, acc=0.995, av_BS_IoU=0.928, av_BS_pa=0.995, loss_iou=0.00738, train_per_mask_iou=0.760]Epoch 0:  11%|█         | 198/1818 [02:46<22:44,  1.19it/s, loss=0.360, v_num=77, loss_focal=0.00446, loss_dice=0.162, distill_loss=0.130, acc=0.990, av_BS_IoU=0.915, av_BS_pa=0.983, loss_iou=0.00474, train_per_mask_iou=0.761] Epoch 0:  11%|█         | 199/1818 [02:47<22:44,  1.19it/s, loss=0.360, v_num=77, loss_focal=0.00446, loss_dice=0.162, distill_loss=0.130, acc=0.990, av_BS_IoU=0.915, av_BS_pa=0.983, loss_iou=0.00474, train_per_mask_iou=0.761]Epoch 0:  11%|█         | 199/1818 [02:47<22:44,  1.19it/s, loss=0.901, v_num=77, loss_focal=0.013, loss_dice=0.370, distill_loss=0.175, acc=0.989, av_BS_IoU=0.494, av_BS_pa=0.988, loss_iou=0.0289, train_per_mask_iou=0.760]   Epoch 0:  11%|█         | 200/1818 [02:48<22:44,  1.19it/s, loss=0.901, v_num=77, loss_focal=0.013, loss_dice=0.370, distill_loss=0.175, acc=0.989, av_BS_IoU=0.494, av_BS_pa=0.988, loss_iou=0.0289, train_per_mask_iou=0.760]Epoch 0:  11%|█         | 200/1818 [02:48<22:44,  1.19it/s, loss=1.890, v_num=77, loss_focal=0.0209, loss_dice=0.675, distill_loss=0.156, acc=0.885, av_BS_IoU=0.113, av_BS_pa=0.893, loss_iou=0.0861, train_per_mask_iou=0.757]Epoch 0:  11%|█         | 201/1818 [02:49<22:42,  1.19it/s, loss=1.890, v_num=77, loss_focal=0.0209, loss_dice=0.675, distill_loss=0.156, acc=0.885, av_BS_IoU=0.113, av_BS_pa=0.893, loss_iou=0.0861, train_per_mask_iou=0.757]Epoch 0:  11%|█         | 201/1818 [02:49<22:42,  1.19it/s, loss=0.282, v_num=77, loss_focal=0.00552, loss_dice=0.104, distill_loss=0.110, acc=0.990, av_BS_IoU=0.882, av_BS_pa=0.990, loss_iou=0.00187, train_per_mask_iou=0.757]Epoch 0:  11%|█         | 202/1818 [02:49<22:39,  1.19it/s, loss=0.282, v_num=77, loss_focal=0.00552, loss_dice=0.104, distill_loss=0.110, acc=0.990, av_BS_IoU=0.882, av_BS_pa=0.990, loss_iou=0.00187, train_per_mask_iou=0.757]Epoch 0:  11%|█         | 202/1818 [02:49<22:39,  1.19it/s, loss=0.250, v_num=77, loss_focal=0.00134, loss_dice=0.0707, distill_loss=0.132, acc=0.996, av_BS_IoU=0.921, av_BS_pa=0.995, loss_iou=0.00444, train_per_mask_iou=0.758]Epoch 0:  11%|█         | 203/1818 [02:50<22:36,  1.19it/s, loss=0.250, v_num=77, loss_focal=0.00134, loss_dice=0.0707, distill_loss=0.132, acc=0.996, av_BS_IoU=0.921, av_BS_pa=0.995, loss_iou=0.00444, train_per_mask_iou=0.758]Epoch 0:  11%|█         | 203/1818 [02:50<22:36,  1.19it/s, loss=0.633, v_num=77, loss_focal=0.0317, loss_dice=0.173, distill_loss=0.136, acc=0.979, av_BS_IoU=0.704, av_BS_pa=0.979, loss_iou=0.0447, train_per_mask_iou=0.758]   Epoch 0:  11%|█         | 204/1818 [02:51<22:38,  1.19it/s, loss=0.633, v_num=77, loss_focal=0.0317, loss_dice=0.173, distill_loss=0.136, acc=0.979, av_BS_IoU=0.704, av_BS_pa=0.979, loss_iou=0.0447, train_per_mask_iou=0.758]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:  11%|█         | 204/1818 [02:51<22:38,  1.19it/s, loss=0.932, v_num=77, loss_focal=0.0114, loss_dice=0.495, distill_loss=0.174, acc=0.968, av_BS_IoU=0.852, av_BS_pa=0.969, loss_iou=0.102, train_per_mask_iou=0.758] Epoch 0:  11%|█▏        | 205/1818 [02:52<22:35,  1.19it/s, loss=0.932, v_num=77, loss_focal=0.0114, loss_dice=0.495, distill_loss=0.174, acc=0.968, av_BS_IoU=0.852, av_BS_pa=0.969, loss_iou=0.102, train_per_mask_iou=0.758]Epoch 0:  11%|█▏        | 205/1818 [02:52<22:35,  1.19it/s, loss=0.627, v_num=77, loss_focal=0.00178, loss_dice=0.205, distill_loss=0.142, acc=0.995, av_BS_IoU=0.881, av_BS_pa=0.991, loss_iou=0.206, train_per_mask_iou=0.759]Epoch 0:  11%|█▏        | 206/1818 [02:52<22:32,  1.19it/s, loss=0.627, v_num=77, loss_focal=0.00178, loss_dice=0.205, distill_loss=0.142, acc=0.995, av_BS_IoU=0.881, av_BS_pa=0.991, loss_iou=0.206, train_per_mask_iou=0.759]Epoch 0:  11%|█▏        | 206/1818 [02:52<22:32,  1.19it/s, loss=0.406, v_num=77, loss_focal=0.00397, loss_dice=0.160, distill_loss=0.157, acc=0.987, av_BS_IoU=0.870, av_BS_pa=0.977, loss_iou=0.0117, train_per_mask_iou=0.759]Epoch 0:  11%|█▏        | 207/1818 [02:53<22:29,  1.19it/s, loss=0.406, v_num=77, loss_focal=0.00397, loss_dice=0.160, distill_loss=0.157, acc=0.987, av_BS_IoU=0.870, av_BS_pa=0.977, loss_iou=0.0117, train_per_mask_iou=0.759]Epoch 0:  11%|█▏        | 207/1818 [02:53<22:29,  1.19it/s, loss=0.290, v_num=77, loss_focal=0.00152, loss_dice=0.0628, distill_loss=0.166, acc=0.997, av_BS_IoU=0.941, av_BS_pa=0.996, loss_iou=0.0111, train_per_mask_iou=0.760]Epoch 0:  11%|█▏        | 208/1818 [02:55<22:34,  1.19it/s, loss=0.290, v_num=77, loss_focal=0.00152, loss_dice=0.0628, distill_loss=0.166, acc=0.997, av_BS_IoU=0.941, av_BS_pa=0.996, loss_iou=0.0111, train_per_mask_iou=0.760]Epoch 0:  11%|█▏        | 208/1818 [02:55<22:34,  1.19it/s, loss=0.626, v_num=77, loss_focal=0.00574, loss_dice=0.330, distill_loss=0.143, acc=0.946, av_BS_IoU=0.790, av_BS_pa=0.974, loss_iou=0.0305, train_per_mask_iou=0.759] Epoch 0:  11%|█▏        | 209/1818 [02:55<22:32,  1.19it/s, loss=0.626, v_num=77, loss_focal=0.00574, loss_dice=0.330, distill_loss=0.143, acc=0.946, av_BS_IoU=0.790, av_BS_pa=0.974, loss_iou=0.0305, train_per_mask_iou=0.759]Epoch 0:  11%|█▏        | 209/1818 [02:55<22:32,  1.19it/s, loss=2.520, v_num=77, loss_focal=0.0295, loss_dice=0.884, distill_loss=0.135, acc=0.987, av_BS_IoU=0.0703, av_BS_pa=0.986, loss_iou=0.155, train_per_mask_iou=0.756] Epoch 0:  12%|█▏        | 210/1818 [02:56<22:33,  1.19it/s, loss=2.520, v_num=77, loss_focal=0.0295, loss_dice=0.884, distill_loss=0.135, acc=0.987, av_BS_IoU=0.0703, av_BS_pa=0.986, loss_iou=0.155, train_per_mask_iou=0.756]Epoch 0:  12%|█▏        | 210/1818 [02:56<22:33,  1.19it/s, loss=0.329, v_num=77, loss_focal=0.00368, loss_dice=0.123, distill_loss=0.134, acc=0.994, av_BS_IoU=0.842, av_BS_pa=0.993, loss_iou=0.00089, train_per_mask_iou=0.757]Epoch 0:  12%|█▏        | 211/1818 [02:57<22:30,  1.19it/s, loss=0.329, v_num=77, loss_focal=0.00368, loss_dice=0.123, distill_loss=0.134, acc=0.994, av_BS_IoU=0.842, av_BS_pa=0.993, loss_iou=0.00089, train_per_mask_iou=0.757]Epoch 0:  12%|█▏        | 211/1818 [02:57<22:30,  1.19it/s, loss=0.848, v_num=77, loss_focal=0.00471, loss_dice=0.511, distill_loss=0.128, acc=0.972, av_BS_IoU=0.661, av_BS_pa=0.978, loss_iou=0.0161, train_per_mask_iou=0.756] Epoch 0:  12%|█▏        | 212/1818 [02:58<22:28,  1.19it/s, loss=0.848, v_num=77, loss_focal=0.00471, loss_dice=0.511, distill_loss=0.128, acc=0.972, av_BS_IoU=0.661, av_BS_pa=0.978, loss_iou=0.0161, train_per_mask_iou=0.756]Epoch 0:  12%|█▏        | 212/1818 [02:58<22:28,  1.19it/s, loss=0.200, v_num=77, loss_focal=0.00103, loss_dice=0.0469, distill_loss=0.114, acc=0.998, av_BS_IoU=0.947, av_BS_pa=0.997, loss_iou=0.00661, train_per_mask_iou=0.757]Epoch 0:  12%|█▏        | 213/1818 [02:58<22:25,  1.19it/s, loss=0.200, v_num=77, loss_focal=0.00103, loss_dice=0.0469, distill_loss=0.114, acc=0.998, av_BS_IoU=0.947, av_BS_pa=0.997, loss_iou=0.00661, train_per_mask_iou=0.757]Epoch 0:  12%|█▏        | 213/1818 [02:58<22:26,  1.19it/s, loss=0.504, v_num=77, loss_focal=0.00338, loss_dice=0.251, distill_loss=0.148, acc=0.989, av_BS_IoU=0.893, av_BS_pa=0.986, loss_iou=0.0322, train_per_mask_iou=0.757]  Epoch 0:  12%|█▏        | 214/1818 [02:59<22:23,  1.19it/s, loss=0.504, v_num=77, loss_focal=0.00338, loss_dice=0.251, distill_loss=0.148, acc=0.989, av_BS_IoU=0.893, av_BS_pa=0.986, loss_iou=0.0322, train_per_mask_iou=0.757]Epoch 0:  12%|█▏        | 214/1818 [02:59<22:23,  1.19it/s, loss=0.370, v_num=77, loss_focal=0.00105, loss_dice=0.104, distill_loss=0.192, acc=0.997, av_BS_IoU=0.890, av_BS_pa=0.995, loss_iou=0.0111, train_per_mask_iou=0.758]Epoch 0:  12%|█▏        | 215/1818 [02:59<22:21,  1.20it/s, loss=0.370, v_num=77, loss_focal=0.00105, loss_dice=0.104, distill_loss=0.192, acc=0.997, av_BS_IoU=0.890, av_BS_pa=0.995, loss_iou=0.0111, train_per_mask_iou=0.758]Epoch 0:  12%|█▏        | 215/1818 [02:59<22:21,  1.20it/s, loss=0.604, v_num=77, loss_focal=0.0023, loss_dice=0.321, distill_loss=0.157, acc=0.990, av_BS_IoU=0.881, av_BS_pa=0.989, loss_iou=0.0476, train_per_mask_iou=0.758] Epoch 0:  12%|█▏        | 216/1818 [03:00<22:18,  1.20it/s, loss=0.604, v_num=77, loss_focal=0.0023, loss_dice=0.321, distill_loss=0.157, acc=0.990, av_BS_IoU=0.881, av_BS_pa=0.989, loss_iou=0.0476, train_per_mask_iou=0.758]Epoch 0:  12%|█▏        | 216/1818 [03:00<22:18,  1.20it/s, loss=0.364, v_num=77, loss_focal=0.00092, loss_dice=0.100, distill_loss=0.149, acc=0.998, av_BS_IoU=0.871, av_BS_pa=0.998, loss_iou=0.0572, train_per_mask_iou=0.759]Epoch 0:  12%|█▏        | 217/1818 [03:01<22:16,  1.20it/s, loss=0.364, v_num=77, loss_focal=0.00092, loss_dice=0.100, distill_loss=0.149, acc=0.998, av_BS_IoU=0.871, av_BS_pa=0.998, loss_iou=0.0572, train_per_mask_iou=0.759]Epoch 0:  12%|█▏        | 217/1818 [03:01<22:16,  1.20it/s, loss=0.540, v_num=77, loss_focal=0.00241, loss_dice=0.287, distill_loss=0.171, acc=0.984, av_BS_IoU=0.918, av_BS_pa=0.990, loss_iou=0.014, train_per_mask_iou=0.759] Epoch 0:  12%|█▏        | 218/1818 [03:01<22:14,  1.20it/s, loss=0.540, v_num=77, loss_focal=0.00241, loss_dice=0.287, distill_loss=0.171, acc=0.984, av_BS_IoU=0.918, av_BS_pa=0.990, loss_iou=0.014, train_per_mask_iou=0.759]Epoch 0:  12%|█▏        | 218/1818 [03:01<22:14,  1.20it/s, loss=0.335, v_num=77, loss_focal=0.00145, loss_dice=0.143, distill_loss=0.133, acc=0.994, av_BS_IoU=0.935, av_BS_pa=0.993, loss_iou=0.0145, train_per_mask_iou=0.760]Epoch 0:  12%|█▏        | 219/1818 [03:02<22:11,  1.20it/s, loss=0.335, v_num=77, loss_focal=0.00145, loss_dice=0.143, distill_loss=0.133, acc=0.994, av_BS_IoU=0.935, av_BS_pa=0.993, loss_iou=0.0145, train_per_mask_iou=0.760]Epoch 0:  12%|█▏        | 219/1818 [03:02<22:11,  1.20it/s, loss=0.723, v_num=77, loss_focal=0.00787, loss_dice=0.316, distill_loss=0.182, acc=0.976, av_BS_IoU=0.681, av_BS_pa=0.945, loss_iou=0.0343, train_per_mask_iou=0.760]Epoch 0:  12%|█▏        | 220/1818 [03:03<22:14,  1.20it/s, loss=0.723, v_num=77, loss_focal=0.00787, loss_dice=0.316, distill_loss=0.182, acc=0.976, av_BS_IoU=0.681, av_BS_pa=0.945, loss_iou=0.0343, train_per_mask_iou=0.760]Epoch 0:  12%|█▏        | 220/1818 [03:03<22:14,  1.20it/s, loss=0.333, v_num=77, loss_focal=0.00128, loss_dice=0.127, distill_loss=0.136, acc=0.143, av_BS_IoU=0.874, av_BS_pa=0.996, loss_iou=0.0156, train_per_mask_iou=0.763]Epoch 0:  12%|█▏        | 221/1818 [03:04<22:12,  1.20it/s, loss=0.333, v_num=77, loss_focal=0.00128, loss_dice=0.127, distill_loss=0.136, acc=0.143, av_BS_IoU=0.874, av_BS_pa=0.996, loss_iou=0.0156, train_per_mask_iou=0.763]Epoch 0:  12%|█▏        | 221/1818 [03:04<22:12,  1.20it/s, loss=0.351, v_num=77, loss_focal=0.00156, loss_dice=0.127, distill_loss=0.151, acc=0.997, av_BS_IoU=0.912, av_BS_pa=0.997, loss_iou=0.0189, train_per_mask_iou=0.764]Epoch 0:  12%|█▏        | 222/1818 [03:04<22:09,  1.20it/s, loss=0.351, v_num=77, loss_focal=0.00156, loss_dice=0.127, distill_loss=0.151, acc=0.997, av_BS_IoU=0.912, av_BS_pa=0.997, loss_iou=0.0189, train_per_mask_iou=0.764]Epoch 0:  12%|█▏        | 222/1818 [03:04<22:09,  1.20it/s, loss=0.964, v_num=77, loss_focal=0.00374, loss_dice=0.551, distill_loss=0.177, acc=0.993, av_BS_IoU=0.774, av_BS_pa=0.989, loss_iou=0.0741, train_per_mask_iou=0.764]Epoch 0:  12%|█▏        | 223/1818 [03:05<22:07,  1.20it/s, loss=0.964, v_num=77, loss_focal=0.00374, loss_dice=0.551, distill_loss=0.177, acc=0.993, av_BS_IoU=0.774, av_BS_pa=0.989, loss_iou=0.0741, train_per_mask_iou=0.764]Epoch 0:  12%|█▏        | 223/1818 [03:05<22:07,  1.20it/s, loss=1.860, v_num=77, loss_focal=0.0476, loss_dice=0.620, distill_loss=0.177, acc=0.930, av_BS_IoU=0.169, av_BS_pa=0.933, loss_iou=0.0184, train_per_mask_iou=0.762] Epoch 0:  12%|█▏        | 224/1818 [03:06<22:08,  1.20it/s, loss=1.860, v_num=77, loss_focal=0.0476, loss_dice=0.620, distill_loss=0.177, acc=0.930, av_BS_IoU=0.169, av_BS_pa=0.933, loss_iou=0.0184, train_per_mask_iou=0.762]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:  12%|█▏        | 224/1818 [03:06<22:08,  1.20it/s, loss=0.550, v_num=77, loss_focal=0.0187, loss_dice=0.195, distill_loss=0.151, acc=0.991, av_BS_IoU=0.713, av_BS_pa=0.991, loss_iou=0.000436, train_per_mask_iou=0.762]Epoch 0:  12%|█▏        | 225/1818 [03:07<22:07,  1.20it/s, loss=0.550, v_num=77, loss_focal=0.0187, loss_dice=0.195, distill_loss=0.151, acc=0.991, av_BS_IoU=0.713, av_BS_pa=0.991, loss_iou=0.000436, train_per_mask_iou=0.762]Epoch 0:  12%|█▏        | 225/1818 [03:07<22:07,  1.20it/s, loss=0.296, v_num=77, loss_focal=0.00157, loss_dice=0.0842, distill_loss=0.158, acc=0.995, av_BS_IoU=0.943, av_BS_pa=0.993, loss_iou=0.00662, train_per_mask_iou=0.762]Epoch 0:  12%|█▏        | 226/1818 [03:08<22:04,  1.20it/s, loss=0.296, v_num=77, loss_focal=0.00157, loss_dice=0.0842, distill_loss=0.158, acc=0.995, av_BS_IoU=0.943, av_BS_pa=0.993, loss_iou=0.00662, train_per_mask_iou=0.762]Epoch 0:  12%|█▏        | 226/1818 [03:08<22:04,  1.20it/s, loss=1.620, v_num=77, loss_focal=0.0126, loss_dice=0.835, distill_loss=0.147, acc=0.975, av_BS_IoU=0.360, av_BS_pa=0.944, loss_iou=0.0308, train_per_mask_iou=0.761]   Epoch 0:  12%|█▏        | 227/1818 [03:09<22:05,  1.20it/s, loss=1.620, v_num=77, loss_focal=0.0126, loss_dice=0.835, distill_loss=0.147, acc=0.975, av_BS_IoU=0.360, av_BS_pa=0.944, loss_iou=0.0308, train_per_mask_iou=0.761]Epoch 0:  12%|█▏        | 227/1818 [03:09<22:05,  1.20it/s, loss=1.470, v_num=77, loss_focal=0.0056, loss_dice=0.705, distill_loss=0.156, acc=0.986, av_BS_IoU=0.275, av_BS_pa=0.963, loss_iou=0.0142, train_per_mask_iou=0.760]Epoch 0:  13%|█▎        | 228/1818 [03:09<22:02,  1.20it/s, loss=1.470, v_num=77, loss_focal=0.0056, loss_dice=0.705, distill_loss=0.156, acc=0.986, av_BS_IoU=0.275, av_BS_pa=0.963, loss_iou=0.0142, train_per_mask_iou=0.760]Epoch 0:  13%|█▎        | 228/1818 [03:09<22:02,  1.20it/s, loss=1.540, v_num=77, loss_focal=0.0829, loss_dice=0.374, distill_loss=0.178, acc=0.922, av_BS_IoU=0.436, av_BS_pa=0.924, loss_iou=0.106, train_per_mask_iou=0.759] Epoch 0:  13%|█▎        | 229/1818 [03:10<22:02,  1.20it/s, loss=1.540, v_num=77, loss_focal=0.0829, loss_dice=0.374, distill_loss=0.178, acc=0.922, av_BS_IoU=0.436, av_BS_pa=0.924, loss_iou=0.106, train_per_mask_iou=0.759]Epoch 0:  13%|█▎        | 229/1818 [03:10<22:02,  1.20it/s, loss=0.918, v_num=77, loss_focal=0.00789, loss_dice=0.460, distill_loss=0.174, acc=0.977, av_BS_IoU=0.861, av_BS_pa=0.975, loss_iou=0.145, train_per_mask_iou=0.759]Epoch 0:  13%|█▎        | 230/1818 [03:11<22:01,  1.20it/s, loss=0.918, v_num=77, loss_focal=0.00789, loss_dice=0.460, distill_loss=0.174, acc=0.977, av_BS_IoU=0.861, av_BS_pa=0.975, loss_iou=0.145, train_per_mask_iou=0.759]Epoch 0:  13%|█▎        | 230/1818 [03:11<22:01,  1.20it/s, loss=0.267, v_num=77, loss_focal=0.000688, loss_dice=0.0695, distill_loss=0.155, acc=0.997, av_BS_IoU=0.970, av_BS_pa=0.996, loss_iou=0.00465, train_per_mask_iou=0.760]Epoch 0:  13%|█▎        | 231/1818 [03:12<21:59,  1.20it/s, loss=0.267, v_num=77, loss_focal=0.000688, loss_dice=0.0695, distill_loss=0.155, acc=0.997, av_BS_IoU=0.970, av_BS_pa=0.996, loss_iou=0.00465, train_per_mask_iou=0.760]Epoch 0:  13%|█▎        | 231/1818 [03:12<21:59,  1.20it/s, loss=0.405, v_num=77, loss_focal=0.00437, loss_dice=0.144, distill_loss=0.176, acc=0.989, av_BS_IoU=0.891, av_BS_pa=0.979, loss_iou=0.00596, train_per_mask_iou=0.761]  Epoch 0:  13%|█▎        | 232/1818 [03:12<21:56,  1.20it/s, loss=0.405, v_num=77, loss_focal=0.00437, loss_dice=0.144, distill_loss=0.176, acc=0.989, av_BS_IoU=0.891, av_BS_pa=0.979, loss_iou=0.00596, train_per_mask_iou=0.761]Epoch 0:  13%|█▎        | 232/1818 [03:12<21:56,  1.20it/s, loss=0.426, v_num=77, loss_focal=0.00181, loss_dice=0.123, distill_loss=0.164, acc=0.995, av_BS_IoU=0.885, av_BS_pa=0.994, loss_iou=0.0726, train_per_mask_iou=0.761] Epoch 0:  13%|█▎        | 233/1818 [03:13<21:54,  1.21it/s, loss=0.426, v_num=77, loss_focal=0.00181, loss_dice=0.123, distill_loss=0.164, acc=0.995, av_BS_IoU=0.885, av_BS_pa=0.994, loss_iou=0.0726, train_per_mask_iou=0.761]Epoch 0:  13%|█▎        | 233/1818 [03:13<21:54,  1.21it/s, loss=1.740, v_num=77, loss_focal=0.0131, loss_dice=0.691, distill_loss=0.150, acc=0.991, av_BS_IoU=0.259, av_BS_pa=0.884, loss_iou=0.157, train_per_mask_iou=0.761]  Epoch 0:  13%|█▎        | 234/1818 [03:15<22:03,  1.20it/s, loss=1.740, v_num=77, loss_focal=0.0131, loss_dice=0.691, distill_loss=0.150, acc=0.991, av_BS_IoU=0.259, av_BS_pa=0.884, loss_iou=0.157, train_per_mask_iou=0.761]Epoch 0:  13%|█▎        | 234/1818 [03:15<22:03,  1.20it/s, loss=0.274, v_num=77, loss_focal=0.00227, loss_dice=0.0705, distill_loss=0.149, acc=0.993, av_BS_IoU=0.964, av_BS_pa=0.990, loss_iou=0.00795, train_per_mask_iou=0.762]Epoch 0:  13%|█▎        | 235/1818 [03:16<22:00,  1.20it/s, loss=0.274, v_num=77, loss_focal=0.00227, loss_dice=0.0705, distill_loss=0.149, acc=0.993, av_BS_IoU=0.964, av_BS_pa=0.990, loss_iou=0.00795, train_per_mask_iou=0.762]Epoch 0:  13%|█▎        | 235/1818 [03:16<22:00,  1.20it/s, loss=0.426, v_num=77, loss_focal=0.00878, loss_dice=0.179, distill_loss=0.146, acc=0.941, av_BS_IoU=0.872, av_BS_pa=0.965, loss_iou=0.000468, train_per_mask_iou=0.762]Epoch 0:  13%|█▎        | 236/1818 [03:16<21:58,  1.20it/s, loss=0.426, v_num=77, loss_focal=0.00878, loss_dice=0.179, distill_loss=0.146, acc=0.941, av_BS_IoU=0.872, av_BS_pa=0.965, loss_iou=0.000468, train_per_mask_iou=0.762]Epoch 0:  13%|█▎        | 236/1818 [03:16<21:58,  1.20it/s, loss=0.420, v_num=77, loss_focal=0.00597, loss_dice=0.177, distill_loss=0.142, acc=0.982, av_BS_IoU=0.886, av_BS_pa=0.972, loss_iou=0.0192, train_per_mask_iou=0.763]  Epoch 0:  13%|█▎        | 237/1818 [03:17<21:56,  1.20it/s, loss=0.420, v_num=77, loss_focal=0.00597, loss_dice=0.177, distill_loss=0.142, acc=0.982, av_BS_IoU=0.886, av_BS_pa=0.972, loss_iou=0.0192, train_per_mask_iou=0.763]Epoch 0:  13%|█▎        | 237/1818 [03:17<21:56,  1.20it/s, loss=0.710, v_num=77, loss_focal=0.00713, loss_dice=0.424, distill_loss=0.151, acc=0.982, av_BS_IoU=0.924, av_BS_pa=0.988, loss_iou=0.0421, train_per_mask_iou=0.763]Epoch 0:  13%|█▎        | 238/1818 [03:18<21:55,  1.20it/s, loss=0.710, v_num=77, loss_focal=0.00713, loss_dice=0.424, distill_loss=0.151, acc=0.982, av_BS_IoU=0.924, av_BS_pa=0.988, loss_iou=0.0421, train_per_mask_iou=0.763]Epoch 0:  13%|█▎        | 238/1818 [03:18<21:55,  1.20it/s, loss=0.540, v_num=77, loss_focal=0.00406, loss_dice=0.311, distill_loss=0.122, acc=0.988, av_BS_IoU=0.835, av_BS_pa=0.984, loss_iou=0.0177, train_per_mask_iou=0.763]Epoch 0:  13%|█▎        | 239/1818 [03:18<21:54,  1.20it/s, loss=0.540, v_num=77, loss_focal=0.00406, loss_dice=0.311, distill_loss=0.122, acc=0.988, av_BS_IoU=0.835, av_BS_pa=0.984, loss_iou=0.0177, train_per_mask_iou=0.763]Epoch 0:  13%|█▎        | 239/1818 [03:18<21:54,  1.20it/s, loss=0.969, v_num=77, loss_focal=0.00198, loss_dice=0.484, distill_loss=0.160, acc=0.995, av_BS_IoU=0.857, av_BS_pa=0.995, loss_iou=0.214, train_per_mask_iou=0.764] Epoch 0:  13%|█▎        | 240/1818 [03:19<21:51,  1.20it/s, loss=0.969, v_num=77, loss_focal=0.00198, loss_dice=0.484, distill_loss=0.160, acc=0.995, av_BS_IoU=0.857, av_BS_pa=0.995, loss_iou=0.214, train_per_mask_iou=0.764]Epoch 0:  13%|█▎        | 240/1818 [03:19<21:51,  1.20it/s, loss=0.280, v_num=77, loss_focal=0.000442, loss_dice=0.0463, distill_loss=0.182, acc=0.999, av_BS_IoU=0.920, av_BS_pa=0.999, loss_iou=0.00175, train_per_mask_iou=0.764]Epoch 0:  13%|█▎        | 241/1818 [03:20<21:49,  1.20it/s, loss=0.280, v_num=77, loss_focal=0.000442, loss_dice=0.0463, distill_loss=0.182, acc=0.999, av_BS_IoU=0.920, av_BS_pa=0.999, loss_iou=0.00175, train_per_mask_iou=0.764]Epoch 0:  13%|█▎        | 241/1818 [03:20<21:49,  1.20it/s, loss=0.298, v_num=77, loss_focal=0.00355, loss_dice=0.0593, distill_loss=0.177, acc=0.992, av_BS_IoU=0.943, av_BS_pa=0.988, loss_iou=0.000346, train_per_mask_iou=0.765]Epoch 0:  13%|█▎        | 242/1818 [03:20<21:47,  1.21it/s, loss=0.298, v_num=77, loss_focal=0.00355, loss_dice=0.0593, distill_loss=0.177, acc=0.992, av_BS_IoU=0.943, av_BS_pa=0.988, loss_iou=0.000346, train_per_mask_iou=0.765]Epoch 0:  13%|█▎        | 242/1818 [03:20<21:47,  1.21it/s, loss=0.573, v_num=77, loss_focal=0.00126, loss_dice=0.286, distill_loss=0.130, acc=0.999, av_BS_IoU=0.567, av_BS_pa=0.999, loss_iou=0.000617, train_per_mask_iou=0.764] Epoch 0:  13%|█▎        | 243/1818 [03:21<21:46,  1.21it/s, loss=0.573, v_num=77, loss_focal=0.00126, loss_dice=0.286, distill_loss=0.130, acc=0.999, av_BS_IoU=0.567, av_BS_pa=0.999, loss_iou=0.000617, train_per_mask_iou=0.764]Epoch 0:  13%|█▎        | 243/1818 [03:21<21:46,  1.21it/s, loss=0.856, v_num=77, loss_focal=0.00197, loss_dice=0.371, distill_loss=0.205, acc=0.333, av_BS_IoU=0.505, av_BS_pa=0.998, loss_iou=0.0176, train_per_mask_iou=0.762]  Epoch 0:  13%|█▎        | 244/1818 [03:22<21:43,  1.21it/s, loss=0.856, v_num=77, loss_focal=0.00197, loss_dice=0.371, distill_loss=0.205, acc=0.333, av_BS_IoU=0.505, av_BS_pa=0.998, loss_iou=0.0176, train_per_mask_iou=0.762]Epoch 0:  13%|█▎        | 244/1818 [03:22<21:43,  1.21it/s, loss=0.509, v_num=77, loss_focal=0.0112, loss_dice=0.206, distill_loss=0.145, acc=0.965, av_BS_IoU=0.738, av_BS_pa=0.970, loss_iou=0.00648, train_per_mask_iou=0.762]Epoch 0:  13%|█▎        | 245/1818 [03:22<21:41,  1.21it/s, loss=0.509, v_num=77, loss_focal=0.0112, loss_dice=0.206, distill_loss=0.145, acc=0.965, av_BS_IoU=0.738, av_BS_pa=0.970, loss_iou=0.00648, train_per_mask_iou=0.762]Epoch 0:  13%|█▎        | 245/1818 [03:22<21:41,  1.21it/s, loss=0.280, v_num=77, loss_focal=0.000836, loss_dice=0.0651, distill_loss=0.162, acc=0.999, av_BS_IoU=0.914, av_BS_pa=0.999, loss_iou=0.00453, train_per_mask_iou=0.762]Epoch 0:  14%|█▎        | 246/1818 [03:23<21:39,  1.21it/s, loss=0.280, v_num=77, loss_focal=0.000836, loss_dice=0.0651, distill_loss=0.162, acc=0.999, av_BS_IoU=0.914, av_BS_pa=0.999, loss_iou=0.00453, train_per_mask_iou=0.762]Epoch 0:  14%|█▎        | 246/1818 [03:23<21:39,  1.21it/s, loss=0.353, v_num=77, loss_focal=0.000893, loss_dice=0.128, distill_loss=0.152, acc=0.993, av_BS_IoU=0.959, av_BS_pa=0.997, loss_iou=0.0318, train_per_mask_iou=0.763]  Epoch 0:  14%|█▎        | 247/1818 [03:24<21:40,  1.21it/s, loss=0.353, v_num=77, loss_focal=0.000893, loss_dice=0.128, distill_loss=0.152, acc=0.993, av_BS_IoU=0.959, av_BS_pa=0.997, loss_iou=0.0318, train_per_mask_iou=0.763]Epoch 0:  14%|█▎        | 247/1818 [03:24<21:40,  1.21it/s, loss=1.920, v_num=77, loss_focal=0.00879, loss_dice=0.874, distill_loss=0.157, acc=0.997, av_BS_IoU=0.351, av_BS_pa=0.977, loss_iou=0.194, train_per_mask_iou=0.763]  Epoch 0:  14%|█▎        | 248/1818 [03:25<21:38,  1.21it/s, loss=1.920, v_num=77, loss_focal=0.00879, loss_dice=0.874, distill_loss=0.157, acc=0.997, av_BS_IoU=0.351, av_BS_pa=0.977, loss_iou=0.194, train_per_mask_iou=0.763]Epoch 0:  14%|█▎        | 248/1818 [03:25<21:38,  1.21it/s, loss=0.619, v_num=77, loss_focal=0.000287, loss_dice=0.258, distill_loss=0.181, acc=1.000, av_BS_IoU=0.623, av_BS_pa=1.000, loss_iou=0.0251, train_per_mask_iou=0.762]Epoch 0:  14%|█▎        | 249/1818 [03:26<21:41,  1.21it/s, loss=0.619, v_num=77, loss_focal=0.000287, loss_dice=0.258, distill_loss=0.181, acc=1.000, av_BS_IoU=0.623, av_BS_pa=1.000, loss_iou=0.0251, train_per_mask_iou=0.762]Epoch 0:  14%|█▎        | 249/1818 [03:26<21:41,  1.21it/s, loss=0.957, v_num=77, loss_focal=0.00716, loss_dice=0.516, distill_loss=0.169, acc=0.977, av_BS_IoU=0.592, av_BS_pa=0.968, loss_iou=0.00725, train_per_mask_iou=0.762]Epoch 0:  14%|█▍        | 250/1818 [03:27<21:39,  1.21it/s, loss=0.957, v_num=77, loss_focal=0.00716, loss_dice=0.516, distill_loss=0.169, acc=0.977, av_BS_IoU=0.592, av_BS_pa=0.968, loss_iou=0.00725, train_per_mask_iou=0.762]Epoch 0:  14%|█▍        | 250/1818 [03:27<21:39,  1.21it/s, loss=0.476, v_num=77, loss_focal=0.00474, loss_dice=0.192, distill_loss=0.158, acc=0.992, av_BS_IoU=0.857, av_BS_pa=0.992, loss_iou=0.0363, train_per_mask_iou=0.762] Epoch 0:  14%|█▍        | 251/1818 [03:28<21:43,  1.20it/s, loss=0.476, v_num=77, loss_focal=0.00474, loss_dice=0.192, distill_loss=0.158, acc=0.992, av_BS_IoU=0.857, av_BS_pa=0.992, loss_iou=0.0363, train_per_mask_iou=0.762]Epoch 0:  14%|█▍        | 251/1818 [03:28<21:43,  1.20it/s, loss=0.359, v_num=77, loss_focal=0.00446, loss_dice=0.114, distill_loss=0.157, acc=0.993, av_BS_IoU=0.861, av_BS_pa=0.992, loss_iou=0.00871, train_per_mask_iou=0.763]Epoch 0:  14%|█▍        | 252/1818 [03:29<21:41,  1.20it/s, loss=0.359, v_num=77, loss_focal=0.00446, loss_dice=0.114, distill_loss=0.157, acc=0.993, av_BS_IoU=0.861, av_BS_pa=0.992, loss_iou=0.00871, train_per_mask_iou=0.763]Epoch 0:  14%|█▍        | 252/1818 [03:29<21:41,  1.20it/s, loss=1.470, v_num=77, loss_focal=0.0146, loss_dice=0.680, distill_loss=0.176, acc=0.982, av_BS_IoU=0.318, av_BS_pa=0.975, loss_iou=0.0048, train_per_mask_iou=0.761]  Epoch 0:  14%|█▍        | 253/1818 [03:34<22:09,  1.18it/s, loss=1.470, v_num=77, loss_focal=0.0146, loss_dice=0.680, distill_loss=0.176, acc=0.982, av_BS_IoU=0.318, av_BS_pa=0.975, loss_iou=0.0048, train_per_mask_iou=0.761]Epoch 0:  14%|█▍        | 253/1818 [03:34<22:09,  1.18it/s, loss=0.982, v_num=77, loss_focal=0.0047, loss_dice=0.481, distill_loss=0.155, acc=0.0995, av_BS_IoU=0.500, av_BS_pa=0.994, loss_iou=0.0461, train_per_mask_iou=0.755]Epoch 0:  14%|█▍        | 254/1818 [03:35<22:09,  1.18it/s, loss=0.982, v_num=77, loss_focal=0.0047, loss_dice=0.481, distill_loss=0.155, acc=0.0995, av_BS_IoU=0.500, av_BS_pa=0.994, loss_iou=0.0461, train_per_mask_iou=0.755]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:  14%|█▍        | 254/1818 [03:35<22:09,  1.18it/s, loss=1.250, v_num=77, loss_focal=0.00918, loss_dice=0.664, distill_loss=0.141, acc=0.985, av_BS_IoU=0.579, av_BS_pa=0.957, loss_iou=0.105, train_per_mask_iou=0.755] Epoch 0:  14%|█▍        | 255/1818 [03:36<22:08,  1.18it/s, loss=1.250, v_num=77, loss_focal=0.00918, loss_dice=0.664, distill_loss=0.141, acc=0.985, av_BS_IoU=0.579, av_BS_pa=0.957, loss_iou=0.105, train_per_mask_iou=0.755]Epoch 0:  14%|█▍        | 255/1818 [03:36<22:08,  1.18it/s, loss=0.299, v_num=77, loss_focal=0.00168, loss_dice=0.0793, distill_loss=0.153, acc=0.996, av_BS_IoU=0.885, av_BS_pa=0.996, loss_iou=0.0109, train_per_mask_iou=0.755]Epoch 0:  14%|█▍        | 256/1818 [03:37<22:07,  1.18it/s, loss=0.299, v_num=77, loss_focal=0.00168, loss_dice=0.0793, distill_loss=0.153, acc=0.996, av_BS_IoU=0.885, av_BS_pa=0.996, loss_iou=0.0109, train_per_mask_iou=0.755]Epoch 0:  14%|█▍        | 256/1818 [03:37<22:07,  1.18it/s, loss=0.722, v_num=77, loss_focal=0.00154, loss_dice=0.304, distill_loss=0.145, acc=0.993, av_BS_IoU=0.927, av_BS_pa=0.994, loss_iou=0.210, train_per_mask_iou=0.756]  Epoch 0:  14%|█▍        | 257/1818 [03:38<22:04,  1.18it/s, loss=0.722, v_num=77, loss_focal=0.00154, loss_dice=0.304, distill_loss=0.145, acc=0.993, av_BS_IoU=0.927, av_BS_pa=0.994, loss_iou=0.210, train_per_mask_iou=0.756]Epoch 0:  14%|█▍        | 257/1818 [03:38<22:04,  1.18it/s, loss=0.493, v_num=77, loss_focal=0.0146, loss_dice=0.192, distill_loss=0.149, acc=0.930, av_BS_IoU=0.857, av_BS_pa=0.953, loss_iou=0.0147, train_per_mask_iou=0.756]Epoch 0:  14%|█▍        | 258/1818 [03:38<22:02,  1.18it/s, loss=0.493, v_num=77, loss_focal=0.0146, loss_dice=0.192, distill_loss=0.149, acc=0.930, av_BS_IoU=0.857, av_BS_pa=0.953, loss_iou=0.0147, train_per_mask_iou=0.756]Epoch 0:  14%|█▍        | 258/1818 [03:38<22:02,  1.18it/s, loss=0.251, v_num=77, loss_focal=0.00316, loss_dice=0.0801, distill_loss=0.119, acc=0.990, av_BS_IoU=0.899, av_BS_pa=0.990, loss_iou=0.00027, train_per_mask_iou=0.756]Epoch 0:  14%|█▍        | 259/1818 [03:39<22:03,  1.18it/s, loss=0.251, v_num=77, loss_focal=0.00316, loss_dice=0.0801, distill_loss=0.119, acc=0.990, av_BS_IoU=0.899, av_BS_pa=0.990, loss_iou=0.00027, train_per_mask_iou=0.756]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:  14%|█▍        | 259/1818 [03:39<22:03,  1.18it/s, loss=0.884, v_num=77, loss_focal=0.00522, loss_dice=0.527, distill_loss=0.143, acc=0.983, av_BS_IoU=0.883, av_BS_pa=0.985, loss_iou=0.108, train_per_mask_iou=0.757]   Epoch 0:  14%|█▍        | 260/1818 [03:40<22:01,  1.18it/s, loss=0.884, v_num=77, loss_focal=0.00522, loss_dice=0.527, distill_loss=0.143, acc=0.983, av_BS_IoU=0.883, av_BS_pa=0.985, loss_iou=0.108, train_per_mask_iou=0.757]Epoch 0:  14%|█▍        | 260/1818 [03:40<22:01,  1.18it/s, loss=1.500, v_num=77, loss_focal=0.0244, loss_dice=0.693, distill_loss=0.151, acc=0.953, av_BS_IoU=0.341, av_BS_pa=0.945, loss_iou=0.00992, train_per_mask_iou=0.755]Epoch 0:  14%|█▍        | 261/1818 [03:41<21:58,  1.18it/s, loss=1.500, v_num=77, loss_focal=0.0244, loss_dice=0.693, distill_loss=0.151, acc=0.953, av_BS_IoU=0.341, av_BS_pa=0.945, loss_iou=0.00992, train_per_mask_iou=0.755]Epoch 0:  14%|█▍        | 261/1818 [03:41<21:58,  1.18it/s, loss=0.277, v_num=77, loss_focal=0.00555, loss_dice=0.0686, distill_loss=0.138, acc=0.994, av_BS_IoU=0.893, av_BS_pa=0.994, loss_iou=6.04e-6, train_per_mask_iou=0.756]Epoch 0:  14%|█▍        | 262/1818 [03:41<21:56,  1.18it/s, loss=0.277, v_num=77, loss_focal=0.00555, loss_dice=0.0686, distill_loss=0.138, acc=0.994, av_BS_IoU=0.893, av_BS_pa=0.994, loss_iou=6.04e-6, train_per_mask_iou=0.756]Epoch 0:  14%|█▍        | 262/1818 [03:41<21:56,  1.18it/s, loss=1.500, v_num=77, loss_focal=0.00385, loss_dice=0.679, distill_loss=0.152, acc=0.997, av_BS_IoU=0.209, av_BS_pa=0.997, loss_iou=0.0262, train_per_mask_iou=0.754]  Epoch 0:  14%|█▍        | 263/1818 [03:42<21:54,  1.18it/s, loss=1.500, v_num=77, loss_focal=0.00385, loss_dice=0.679, distill_loss=0.152, acc=0.997, av_BS_IoU=0.209, av_BS_pa=0.997, loss_iou=0.0262, train_per_mask_iou=0.754]Epoch 0:  14%|█▍        | 263/1818 [03:42<21:54,  1.18it/s, loss=1.230, v_num=77, loss_focal=0.00813, loss_dice=0.667, distill_loss=0.185, acc=0.967, av_BS_IoU=0.517, av_BS_pa=0.962, loss_iou=0.000552, train_per_mask_iou=0.753]Epoch 0:  15%|█▍        | 264/1818 [03:42<21:52,  1.18it/s, loss=1.230, v_num=77, loss_focal=0.00813, loss_dice=0.667, distill_loss=0.185, acc=0.967, av_BS_IoU=0.517, av_BS_pa=0.962, loss_iou=0.000552, train_per_mask_iou=0.753]Epoch 0:  15%|█▍        | 264/1818 [03:42<21:52,  1.18it/s, loss=0.451, v_num=77, loss_focal=0.00216, loss_dice=0.149, distill_loss=0.154, acc=0.988, av_BS_IoU=0.904, av_BS_pa=0.991, loss_iou=0.086, train_per_mask_iou=0.754]   Epoch 0:  15%|█▍        | 265/1818 [03:43<21:50,  1.18it/s, loss=0.451, v_num=77, loss_focal=0.00216, loss_dice=0.149, distill_loss=0.154, acc=0.988, av_BS_IoU=0.904, av_BS_pa=0.991, loss_iou=0.086, train_per_mask_iou=0.754]Epoch 0:  15%|█▍        | 265/1818 [03:43<21:50,  1.18it/s, loss=0.333, v_num=77, loss_focal=0.000618, loss_dice=0.0317, distill_loss=0.244, acc=0.998, av_BS_IoU=0.979, av_BS_pa=0.998, loss_iou=0.00204, train_per_mask_iou=0.754]Epoch 0:  15%|█▍        | 266/1818 [03:44<21:48,  1.19it/s, loss=0.333, v_num=77, loss_focal=0.000618, loss_dice=0.0317, distill_loss=0.244, acc=0.998, av_BS_IoU=0.979, av_BS_pa=0.998, loss_iou=0.00204, train_per_mask_iou=0.754]Epoch 0:  15%|█▍        | 266/1818 [03:44<21:48,  1.19it/s, loss=0.305, v_num=77, loss_focal=0.00094, loss_dice=0.0814, distill_loss=0.155, acc=0.995, av_BS_IoU=0.951, av_BS_pa=0.996, loss_iou=0.0249, train_per_mask_iou=0.755]  Epoch 0:  15%|█▍        | 267/1818 [03:47<22:00,  1.17it/s, loss=0.305, v_num=77, loss_focal=0.00094, loss_dice=0.0814, distill_loss=0.155, acc=0.995, av_BS_IoU=0.951, av_BS_pa=0.996, loss_iou=0.0249, train_per_mask_iou=0.755]Epoch 0:  15%|█▍        | 267/1818 [03:47<22:00,  1.17it/s, loss=0.835, v_num=77, loss_focal=0.0149, loss_dice=0.391, distill_loss=0.172, acc=0.939, av_BS_IoU=0.612, av_BS_pa=0.926, loss_iou=0.000499, train_per_mask_iou=0.754]Epoch 0:  15%|█▍        | 268/1818 [03:48<22:04,  1.17it/s, loss=0.835, v_num=77, loss_focal=0.0149, loss_dice=0.391, distill_loss=0.172, acc=0.939, av_BS_IoU=0.612, av_BS_pa=0.926, loss_iou=0.000499, train_per_mask_iou=0.754]Epoch 0:  15%|█▍        | 268/1818 [03:48<22:04,  1.17it/s, loss=0.415, v_num=77, loss_focal=0.00111, loss_dice=0.198, distill_loss=0.109, acc=0.0768, av_BS_IoU=0.810, av_BS_pa=0.997, loss_iou=0.0414, train_per_mask_iou=0.759]Epoch 0:  15%|█▍        | 269/1818 [03:49<22:01,  1.17it/s, loss=0.415, v_num=77, loss_focal=0.00111, loss_dice=0.198, distill_loss=0.109, acc=0.0768, av_BS_IoU=0.810, av_BS_pa=0.997, loss_iou=0.0414, train_per_mask_iou=0.759]Epoch 0:  15%|█▍        | 269/1818 [03:49<22:01,  1.17it/s, loss=0.925, v_num=77, loss_focal=0.000771, loss_dice=0.559, distill_loss=0.137, acc=0.500, av_BS_IoU=0.631, av_BS_pa=0.999, loss_iou=0.027, train_per_mask_iou=0.758] Epoch 0:  15%|█▍        | 270/1818 [03:50<22:01,  1.17it/s, loss=0.925, v_num=77, loss_focal=0.000771, loss_dice=0.559, distill_loss=0.137, acc=0.500, av_BS_IoU=0.631, av_BS_pa=0.999, loss_iou=0.027, train_per_mask_iou=0.758]Epoch 0:  15%|█▍        | 270/1818 [03:50<22:01,  1.17it/s, loss=0.409, v_num=77, loss_focal=0.00097, loss_dice=0.139, distill_loss=0.149, acc=0.997, av_BS_IoU=0.885, av_BS_pa=0.996, loss_iou=0.0637, train_per_mask_iou=0.759]Epoch 0:  15%|█▍        | 271/1818 [03:51<21:59,  1.17it/s, loss=0.409, v_num=77, loss_focal=0.00097, loss_dice=0.139, distill_loss=0.149, acc=0.997, av_BS_IoU=0.885, av_BS_pa=0.996, loss_iou=0.0637, train_per_mask_iou=0.759]Epoch 0:  15%|█▍        | 271/1818 [03:51<21:59,  1.17it/s, loss=0.216, v_num=77, loss_focal=0.000915, loss_dice=0.0568, distill_loss=0.117, acc=0.499, av_BS_IoU=0.932, av_BS_pa=0.997, loss_iou=0.00603, train_per_mask_iou=0.760]Epoch 0:  15%|█▍        | 272/1818 [03:51<21:58,  1.17it/s, loss=0.216, v_num=77, loss_focal=0.000915, loss_dice=0.0568, distill_loss=0.117, acc=0.499, av_BS_IoU=0.932, av_BS_pa=0.997, loss_iou=0.00603, train_per_mask_iou=0.760]Epoch 0:  15%|█▍        | 272/1818 [03:51<21:58,  1.17it/s, loss=1.580, v_num=77, loss_focal=0.0197, loss_dice=0.701, distill_loss=0.151, acc=0.136, av_BS_IoU=0.330, av_BS_pa=0.918, loss_iou=0.0692, train_per_mask_iou=0.753]    Epoch 0:  15%|█▌        | 273/1818 [03:52<21:56,  1.17it/s, loss=1.580, v_num=77, loss_focal=0.0197, loss_dice=0.701, distill_loss=0.151, acc=0.136, av_BS_IoU=0.330, av_BS_pa=0.918, loss_iou=0.0692, train_per_mask_iou=0.753]Epoch 0:  15%|█▌        | 273/1818 [03:52<21:56,  1.17it/s, loss=0.525, v_num=77, loss_focal=0.00189, loss_dice=0.230, distill_loss=0.141, acc=0.998, av_BS_IoU=0.684, av_BS_pa=0.998, loss_iou=0.0332, train_per_mask_iou=0.753]Epoch 0:  15%|█▌        | 274/1818 [03:53<21:54,  1.17it/s, loss=0.525, v_num=77, loss_focal=0.00189, loss_dice=0.230, distill_loss=0.141, acc=0.998, av_BS_IoU=0.684, av_BS_pa=0.998, loss_iou=0.0332, train_per_mask_iou=0.753]Epoch 0:  15%|█▌        | 274/1818 [03:53<21:54,  1.17it/s, loss=0.287, v_num=77, loss_focal=0.00592, loss_dice=0.0682, distill_loss=0.144, acc=0.990, av_BS_IoU=0.893, av_BS_pa=0.988, loss_iou=0.000532, train_per_mask_iou=0.753]Epoch 0:  15%|█▌        | 275/1818 [03:53<21:52,  1.18it/s, loss=0.287, v_num=77, loss_focal=0.00592, loss_dice=0.0682, distill_loss=0.144, acc=0.990, av_BS_IoU=0.893, av_BS_pa=0.988, loss_iou=0.000532, train_per_mask_iou=0.753]Epoch 0:  15%|█▌        | 275/1818 [03:53<21:52,  1.18it/s, loss=0.504, v_num=77, loss_focal=0.00532, loss_dice=0.210, distill_loss=0.180, acc=0.985, av_BS_IoU=0.794, av_BS_pa=0.981, loss_iou=0.000322, train_per_mask_iou=0.753] Epoch 0:  15%|█▌        | 276/1818 [03:54<21:51,  1.18it/s, loss=0.504, v_num=77, loss_focal=0.00532, loss_dice=0.210, distill_loss=0.180, acc=0.985, av_BS_IoU=0.794, av_BS_pa=0.981, loss_iou=0.000322, train_per_mask_iou=0.753]Epoch 0:  15%|█▌        | 276/1818 [03:54<21:51,  1.18it/s, loss=0.326, v_num=77, loss_focal=0.000878, loss_dice=0.118, distill_loss=0.151, acc=0.998, av_BS_IoU=0.916, av_BS_pa=0.997, loss_iou=0.00859, train_per_mask_iou=0.754]Epoch 0:  15%|█▌        | 277/1818 [03:56<21:53,  1.17it/s, loss=0.326, v_num=77, loss_focal=0.000878, loss_dice=0.118, distill_loss=0.151, acc=0.998, av_BS_IoU=0.916, av_BS_pa=0.997, loss_iou=0.00859, train_per_mask_iou=0.754]Epoch 0:  15%|█▌        | 277/1818 [03:56<21:53,  1.17it/s, loss=0.601, v_num=77, loss_focal=0.00983, loss_dice=0.268, distill_loss=0.177, acc=0.945, av_BS_IoU=0.844, av_BS_pa=0.958, loss_iou=0.0246, train_per_mask_iou=0.754]  Epoch 0:  15%|█▌        | 278/1818 [03:57<21:53,  1.17it/s, loss=0.601, v_num=77, loss_focal=0.00983, loss_dice=0.268, distill_loss=0.177, acc=0.945, av_BS_IoU=0.844, av_BS_pa=0.958, loss_iou=0.0246, train_per_mask_iou=0.754]/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/callbacks/progress/base.py:249: UserWarning: The progress bar already tracks a metric with the name(s) 'loss' and `self.log('loss', ..., prog_bar=True)` will overwrite this value.  If this is undesired, change the name or override `get_metrics()` in the progress bar callback.
  rank_zero_warn(
Epoch 0:  15%|█▌        | 278/1818 [03:57<21:53,  1.17it/s, loss=0.326, v_num=77, loss_focal=0.00237, loss_dice=0.121, distill_loss=0.149, acc=0.992, av_BS_IoU=0.967, av_BS_pa=0.989, loss_iou=0.00885, train_per_mask_iou=0.754]Epoch 0:  15%|█▌        | 279/1818 [03:57<21:50,  1.17it/s, loss=0.326, v_num=77, loss_focal=0.00237, loss_dice=0.121, distill_loss=0.149, acc=0.992, av_BS_IoU=0.967, av_BS_pa=0.989, loss_iou=0.00885, train_per_mask_iou=0.754]Epoch 0:  15%|█▌        | 279/1818 [03:57<21:50,  1.17it/s, loss=0.236, v_num=77, loss_focal=0.00286, loss_dice=0.0313, distill_loss=0.155, acc=0.993, av_BS_IoU=0.964, av_BS_pa=0.990, loss_iou=0.000605, train_per_mask_iou=0.755]Epoch 0:  15%|█▌        | 280/1818 [03:58<21:48,  1.18it/s, loss=0.236, v_num=77, loss_focal=0.00286, loss_dice=0.0313, distill_loss=0.155, acc=0.993, av_BS_IoU=0.964, av_BS_pa=0.990, loss_iou=0.000605, train_per_mask_iou=0.755]Epoch 0:  15%|█▌        | 280/1818 [03:58<21:48,  1.18it/s, loss=0.415, v_num=77, loss_focal=0.00114, loss_dice=0.130, distill_loss=0.143, acc=0.994, av_BS_IoU=0.922, av_BS_pa=0.995, loss_iou=0.0918, train_per_mask_iou=0.755]   Epoch 0:  15%|█▌        | 281/1818 [03:58<21:46,  1.18it/s, loss=0.415, v_num=77, loss_focal=0.00114, loss_dice=0.130, distill_loss=0.143, acc=0.994, av_BS_IoU=0.922, av_BS_pa=0.995, loss_iou=0.0918, train_per_mask_iou=0.755]Epoch 0:  15%|█▌        | 281/1818 [03:58<21:46,  1.18it/s, loss=0.885, v_num=77, loss_focal=0.0038, loss_dice=0.420, distill_loss=0.148, acc=0.992, av_BS_IoU=0.790, av_BS_pa=0.983, loss_iou=0.175, train_per_mask_iou=0.756]  Epoch 0:  16%|█▌        | 282/1818 [04:00<21:49,  1.17it/s, loss=0.885, v_num=77, loss_focal=0.0038, loss_dice=0.420, distill_loss=0.148, acc=0.992, av_BS_IoU=0.790, av_BS_pa=0.983, loss_iou=0.175, train_per_mask_iou=0.756]Epoch 0:  16%|█▌        | 282/1818 [04:00<21:49,  1.17it/s, loss=0.267, v_num=77, loss_focal=0.000783, loss_dice=0.0869, distill_loss=0.120, acc=0.998, av_BS_IoU=0.901, av_BS_pa=0.997, loss_iou=0.0195, train_per_mask_iou=0.756]Epoch 0:  16%|█▌        | 283/1818 [04:00<21:47,  1.17it/s, loss=0.267, v_num=77, loss_focal=0.000783, loss_dice=0.0869, distill_loss=0.120, acc=0.998, av_BS_IoU=0.901, av_BS_pa=0.997, loss_iou=0.0195, train_per_mask_iou=0.756]Epoch 0:  16%|█▌        | 283/1818 [04:00<21:47,  1.17it/s, loss=0.237, v_num=77, loss_focal=0.00291, loss_dice=0.0619, distill_loss=0.127, acc=0.992, av_BS_IoU=0.941, av_BS_pa=0.991, loss_iou=0.00153, train_per_mask_iou=0.757]Epoch 0:  16%|█▌        | 284/1818 [04:01<21:45,  1.18it/s, loss=0.237, v_num=77, loss_focal=0.00291, loss_dice=0.0619, distill_loss=0.127, acc=0.992, av_BS_IoU=0.941, av_BS_pa=0.991, loss_iou=0.00153, train_per_mask_iou=0.757]Epoch 0:  16%|█▌        | 284/1818 [04:01<21:45,  1.18it/s, loss=0.302, v_num=77, loss_focal=0.00347, loss_dice=0.0997, distill_loss=0.134, acc=0.995, av_BS_IoU=0.849, av_BS_pa=0.994, loss_iou=0.000619, train_per_mask_iou=0.757]Error occurred while processing images: ['Mytilopsis_leucophaeata###442946803.jpg']
Error details: CUDA out of memory. Tried to allocate 384.00 MiB (GPU 0; 10.76 GiB total capacity; 6.88 GiB already allocated; 138.12 MiB free; 6.94 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Traceback (most recent call last):
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 36, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 88, in launch
    return function(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1103, in _run
    results = self._run_stage()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1182, in _run_stage
    self._run_train()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1205, in _run_train
    self.fit_loop.run()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1347, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/core/module.py", line 1744, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py", line 280, in optimizer_step
    optimizer_output = super().optimizer_step(optimizer, opt_idx, closure, model, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1485, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py", line 351, in training_step
    return self.model(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/overrides/base.py", line 98, in forward
    output = self._forward_module.training_step(*inputs, **kwargs)
  File "/data2/wuxinrui/RA-L/MobileSAM/DistillFinetune/Imgencoder_Distill.py", line 320, in training_step
    outputs = self(imgs, bboxes, labels, center_points, point_labels,category_ids,original_input_size,resized_input_size, coco_image_names)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data2/wuxinrui/RA-L/MobileSAM/DistillFinetune/Imgencoder_Distill.py", line 312, in forward
    raise e
  File "/data2/wuxinrui/RA-L/MobileSAM/DistillFinetune/Imgencoder_Distill.py", line 249, in forward
    batch_tp, batch_fp, batch_fn, batch_tn = smp.metrics.get_stats(
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/segmentation_models_pytorch/metrics/functional.py", line 172, in get_stats
    target = torch.where(target >= threshold, 1, 0)
RuntimeError: CUDA out of memory. Tried to allocate 384.00 MiB (GPU 0; 10.76 GiB total capacity; 6.88 GiB already allocated; 138.12 MiB free; 6.94 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data2/wuxinrui/RA-L/MobileSAM/distill_tiny_msam.py", line 171, in <module>
    main()
  File "/data2/wuxinrui/RA-L/MobileSAM/distill_tiny_msam.py", line 157, in main
    trainer.fit(model)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 59, in _call_and_handle_interrupt
    trainer.strategy.reconciliate_processes(traceback.format_exc())
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py", line 460, in reconciliate_processes
    raise DeadlockDetectedException(f"DeadLock detected from rank: {self.global_rank} \n {trace}")
pytorch_lightning.utilities.exceptions.DeadlockDetectedException: DeadLock detected from rank: 0 
 Traceback (most recent call last):
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 36, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 88, in launch
    return function(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1103, in _run
    results = self._run_stage()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1182, in _run_stage
    self._run_train()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1205, in _run_train
    self.fit_loop.run()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/training_epoch_loop.py", line 213, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/batch/training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 202, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 249, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 370, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1347, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/core/module.py", line 1744, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/core/optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py", line 280, in optimizer_step
    optimizer_output = super().optimizer_step(optimizer, opt_idx, closure, model, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/plugins/precision/native_amp.py", line 75, in optimizer_step
    closure_result = closure()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 149, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 135, in closure
    step_output = self._step_fn()
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/optimizer_loop.py", line 419, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1485, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py", line 351, in training_step
    return self.model(*args, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/pytorch_lightning/overrides/base.py", line 98, in forward
    output = self._forward_module.training_step(*inputs, **kwargs)
  File "/data2/wuxinrui/RA-L/MobileSAM/DistillFinetune/Imgencoder_Distill.py", line 320, in training_step
    outputs = self(imgs, bboxes, labels, center_points, point_labels,category_ids,original_input_size,resized_input_size, coco_image_names)
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data2/wuxinrui/RA-L/MobileSAM/DistillFinetune/Imgencoder_Distill.py", line 312, in forward
    raise e
  File "/data2/wuxinrui/RA-L/MobileSAM/DistillFinetune/Imgencoder_Distill.py", line 249, in forward
    batch_tp, batch_fp, batch_fn, batch_tn = smp.metrics.get_stats(
  File "/data2/wuxinrui/anaconda/envs/mobilesam/lib/python3.9/site-packages/segmentation_models_pytorch/metrics/functional.py", line 172, in get_stats
    target = torch.where(target >= threshold, 1, 0)
RuntimeError: CUDA out of memory. Tried to allocate 384.00 MiB (GPU 0; 10.76 GiB total capacity; 6.88 GiB already allocated; 138.12 MiB free; 6.94 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Epoch 0:  16%|█▌        | 284/1818 [04:09<22:28,  1.14it/s, loss=0.302, v_num=77, loss_focal=0.00347, loss_dice=0.0997, distill_loss=0.134, acc=0.995, av_BS_IoU=0.849, av_BS_pa=0.994, loss_iou=0.000619, train_per_mask_iou=0.757]
Error in loading image:  Styela_montereyensis###19956212.jpg
Error:  index 0 is out of bounds for dimension 1 with size 0
Error in loading image:  Styela_montereyensis###16072895.jpg
Error:  index 0 is out of bounds for dimension 1 with size 0
Error in loading image:  Styela_montereyensis###16072895.jpg
Error:  index 0 is out of bounds for dimension 1 with size 0
